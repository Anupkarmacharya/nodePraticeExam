!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){module.exports={careers:{head:"Career Inquiry",body:"<p>Nice to meet you! Tell us who you are and how to contact you and we&#39;ll be in\ntouch.</p>\n"},contact:{head:"Contact Us",body:"<p>Questions about N|Solid or what we do? We&#39;ll get back to you as soon as we can!</p>\n"},nship:{head:"Request More Info",body:"<p>Right on! We&#39;ll get you more information on N|Ship ASAP! First, tell\nus who you are, and how to contact you.</p>\n"},training:{head:"Training",body:"<p>Our experts are ready to get you up and running with Node! Just tell us how to reach you and we&#39;ll be in touch ASAP.</p>\n"}}},{}],2:[function(require,module,exports){"use strict";function showForm(context){if(visible=!0,classes.add("contact-form-visible"),"careers"===context)return formTitle.innerHTML=escape(copy.careers.head),formCopy.innerHTML=copy.careers.body,formTopics&&(formTopics.style.display="none",labelTopic.style.display="none"),showCareers();formTitle.innerHTML=escape(copy.contact.head),formCopy.innerHTML=copy.contact.body;for(var i=0;i<form.topic.length;i++){var box=form.topic[i];box.checked=box.value===context}form.querySelector(":checked")||(form.querySelector('[value="general"]').checked=!0)}function hideForm(){form.querySelectorAll("[name]");visible=!1,classes.remove("contact-form-visible"),classes.remove("contact-form-success"),classes.remove("contact-form-pending"),hideCareers()}function showCareers(){var formCareers=domify(careers);formFields.insertBefore(formCareers,labelTopic)}function hideCareers(){for(var careersFields=form.querySelectorAll('[type="url"]'),i=0;i<careersFields.length;i++){var field=careersFields[i];formFields.removeChild(field)}formTopics.style.display="",labelTopic.style.display=""}function preventDefault(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function submitForm(){for(var inputFields=form.querySelectorAll("[name]"),data={},i=0;i<inputFields.length;i++){var field=inputFields[i];"checkbox"===field.type&&field.checked&&(data[field.name]?data[field.name].push(field.value):data[field.name]=[field.value]),"checkbox"!==field.type&&(data[field.name]=field.value)}data.github&&data.linkedin&&(data.topic="careers"),data.topic||(data.topic=["general"]),formSubmit.disabled=!0,classes.add("contact-form-pending"),events.once("success",succeedForm),events.emit("submit",data)}function succeedForm(){formSubmit.disabled=!1,classes.remove("contact-form-pending"),classes.add("contact-form-success"),setTimeout(hideForm,2e3),setTimeout(cleanupForm,2e3)}function errorForm(error){formSubmit.disabled=!1,formError.innerHTML=escape(error.message||error),formError.style.display="block",classes.remove("contact-form-success"),classes.remove("contact-form-pending")}function cleanupForm(){for(var inputFields=form.querySelectorAll("[name]"),i=0;i<inputFields.length;i++){var field=inputFields[i];"SELECT"!==field.nodeName&&(field.value=""),"checkbox"===field.type&&field.checked&&(field.checked=!1)}}var findup=require("findup-element"),escape=require("escape-html"),cl=require("class-list"),minstache=require("minstache"),topics=require("./topics"),Emitter=require("events/"),copy=require("./copy"),domify=require("domify"),template='<form class="modal contact-form" name="contact-form">\n  <h2 class="contact-form-title">Contact Us</h2>\n  <div class="contact-form-close">&times;</div>\n  <div class="contact-form-main cf form-content">\n    <div class="contact-form-copy">\n      <p>\n        Questions about N|Solid or what we do?\n        We\'ll get back to you as soon as we can!\n      </p>\n    </div>\n    <p class="contact-form-error"></p>\n\n    <div class="contact-form-fields">\n      <div class="two-column">\n        <input required type="text" name="first_name" placeholder="First Name">\n        <input type="text" name="last_name" placeholder="Last Name">\n      </div>\n      <input required type="email" name="email" placeholder="Email Address">\n      <input required type="text" name="company" placeholder="Company">\n      <input type="text" name="phone" placeholder="Phone Number (Optional)">\n\n      <label for="topic">\n        What\'s on your mind?\n      </label>\n      <div class="contact-form-topics">\n        {{#topics}}\n          <div class="contact-form-checkbox">\n            <label>\n              <input type="checkbox" name="topic" value="{{slug}}"> {{name}}\n            </label>\n          </div>\n        {{/topics}}\n      </div>\n\n      <textarea name="message" placeholder="Further questions or comments (optional)"></textarea>\n    </div>\n\n    <input class="primary button" type="submit" value="Submit">\n    <input class="button" type="reset" value="Cancel">\n  </div>\n  <div class="contact-form-complete cf">\n    <h3>Message Sent</h3>\n    <p>Thanks for your interest in NodeSource!<br/>We\'ll get back to you ASAP.</p>\n  </div>\n</form>\n',careers='<input required type="url" name="github" pattern="https?://(?:www.)?github\\.com/.+"  placeholder="http://github.com/...">\n<input required type="url" name="linkedin" pattern="https?://(?www.)?linkedin\\.com/in/.+" placeholder="http://linkedin.com/in/...">\n',html=minstache(template,{topics:topics}),classes=cl(document.body),background=domify('<div class="contact-form-background"></div>'),form=domify(html),formFields=form.querySelector(".contact-form-fields"),formClose=form.querySelector(".contact-form-close"),formError=form.querySelector(".contact-form-error"),formTitle=form.querySelector(".contact-form-title"),formCopy=form.querySelector(".contact-form-copy"),formSubmit=(form.querySelector('[type="reset"]'),form.querySelector('[type="submit"]')),labelTopic=form.querySelector("[for=topic]"),formTopics=form.querySelector(".contact-form-topics"),events=new Emitter,visible=!1;module.exports=events.on("error",errorForm),document.body.appendChild(form),document.body.appendChild(background),window.onload=function(){"#contact"===document.location.hash&&showForm("contact")},window.addEventListener("click",function(e){if(!findup(e.target,form)){if(visible)return hideForm(),preventDefault(e);var button=findup(e.target,function(button){return button.hasAttribute&&button.hasAttribute("data-contact")});if(button)return showForm(button.getAttribute("data-contact")),preventDefault(e)}},!1),formClose.addEventListener("click",hideForm,!1),form.addEventListener("submit",function(e){return submitForm(),preventDefault(e)},!1),form.addEventListener("reset",function(e){return hideForm(),preventDefault(e)},!1),window.addEventListener("keydown",function(e){27===e.keyCode&&visible&&hideForm()},!1)},{"./copy":1,"./topics":10,"class-list":3,domify:5,"escape-html":6,"events/":7,"findup-element":8,minstache:9}],3:[function(require,module,exports){function ClassList(elem){function add(token){var list=getTokens();indexof(list,token)>-1||(list.push(token),setTokens(list))}function remove(token){var list=getTokens(),index=indexof(list,token);-1!==index&&(list.splice(index,1),setTokens(list))}function contains(token){return indexof(getTokens(),token)>-1}function toggle(token){return contains(token)?(remove(token),!1):(add(token),!0)}function $toString(){return elem.className}function item(index){var tokens=getTokens();return tokens[index]||null}function getTokens(){var className=elem.className;return filter(className.split(" "),isTruthy)}function setTokens(list){var length=list.length;elem.className=list.join(" "),classList.length=length;for(var i=0;i<list.length;i++)classList[i]=list[i];delete list[length]}var cl=elem.classList;if(cl)return cl;var classList={add:add,remove:remove,contains:contains,toggle:toggle,toString:$toString,length:0,item:item};return classList}function filter(arr,fn){for(var ret=[],i=0;i<arr.length;i++)fn(arr[i])&&ret.push(arr[i]);return ret}function isTruthy(value){return!!value}var indexof=require("indexof");module.exports=ClassList},{indexof:4}],4:[function(require,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],5:[function(require,module,exports){function parse(html,doc){if("string"!=typeof html)throw new TypeError("String expected");doc||(doc=document);var m=/<([\w:]+)/.exec(html);if(!m)return doc.createTextNode(html);html=html.replace(/^\s+|\s+$/g,"");var tag=m[1];if("body"==tag){var el=doc.createElement("html");return el.innerHTML=html,el.removeChild(el.lastChild)}var wrap=map[tag]||map._default,depth=wrap[0],prefix=wrap[1],suffix=wrap[2],el=doc.createElement("div");for(el.innerHTML=prefix+html+suffix;depth--;)el=el.lastChild;if(el.firstChild==el.lastChild)return el.removeChild(el.firstChild);for(var fragment=doc.createDocumentFragment();el.firstChild;)fragment.appendChild(el.removeChild(el.firstChild));return fragment}module.exports=parse;var bugTestDiv,innerHTMLBug=!1;"undefined"!=typeof document&&(bugTestDiv=document.createElement("div"),bugTestDiv.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',innerHTMLBug=!bugTestDiv.getElementsByTagName("link").length,bugTestDiv=void 0);var map={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:innerHTMLBug?[1,"X<div>","</div>"]:[0,"",""]};map.td=map.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],map.option=map.optgroup=[1,'<select multiple="multiple">',"</select>"],map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,"<table>","</table>"],map.polyline=map.ellipse=map.polygon=map.circle=map.text=map.line=map.path=map.rect=map.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"]},{}],6:[function(require,module,exports){"use strict";function escapeHtml(string){var str=""+string,match=matchHtmlRegExp.exec(str);if(!match)return str;var escape,html="",index=0,lastIndex=0;for(index=match.index;index<str.length;index++){switch(str.charCodeAt(index)){case 34:escape="&quot;";break;case 38:escape="&amp;";break;case 39:escape="&#39;";break;case 60:escape="&lt;";break;case 62:escape="&gt;";break;default:continue}lastIndex!==index&&(html+=str.substring(lastIndex,index)),lastIndex=index+1,html+=escape}return lastIndex!==index?html+str.substring(lastIndex,index):html}var matchHtmlRegExp=/["'&<>]/;module.exports=escapeHtml},{}],7:[function(require,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||0>n||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.')}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),listeners=handler.slice(),len=listeners.length,i=0;len>i;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)}},{}],8:[function(require,module,exports){function findup(child,check){for("string"==typeof check&&(check=byName(check)),"function"!=typeof check&&(check=byExact(check));child&&!check(child);)child=child.parentNode;return child||null}function byName(name){return name=String(name).toUpperCase(),function(element){return name===element.nodeName}}function byExact(el){return function(element){return el===element}}module.exports=findup},{}],9:[function(require,module,exports){function render(str,obj){obj=obj||{};var fn=compile(str);return fn(obj)}function compile(str){for(var tok,js=[],toks=parse(str),i=0;i<toks.length;++i)if(tok=toks[i],i%2==0)js.push('"'+tok.replace(/"/g,'\\"')+'"');else switch(tok[0]){case"/":tok=tok.slice(1),js.push(" }) + ");break;case"^":tok=tok.slice(1),assertProperty(tok),js.push(' + section(obj, "'+tok+'", true, function(obj){ return ');break;case"#":tok=tok.slice(1),assertProperty(tok),js.push(' + section(obj, "'+tok+'", false, function(obj){ return ');break;case"!":tok=tok.slice(1),assertProperty(tok),js.push(" + obj."+tok+" + ");break;default:assertProperty(tok),js.push(" + escape(obj."+tok+") + ")}return js="\n"+indent(escape.toString())+";\n\n"+indent(section.toString())+";\n\n  return "+js.join("").replace(/\n/g,"\\n"),new Function("obj",js)}function assertProperty(prop){if(!prop.match(/^[\w.]+$/))throw new Error('invalid property "'+prop+'"')}function parse(str){return str.split(/\{\{|\}\}/)}function indent(str){return str.replace(/^/gm,"  ")}function section(obj,prop,negate,thunk){var val=obj[prop];return Array.isArray(val)?val.map(thunk).join(""):"function"==typeof val?val.call(obj,thunk(obj)):(negate&&(val=!val),val?thunk(obj):"")}function escape(html){return String(html).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}exports=module.exports=render,exports.compile=compile},{}],10:[function(require,module,exports){module.exports=[{name:"N|Solid",slug:"nsolid"},{name:"Media Inquiry",slug:"media"},{name:"Node Training",slug:"training"},{name:"N|Support",slug:"nsupport"},{name:"N|Ship",slug:"nship"},{name:"General Question",slug:"general"}]},{}],11:[function(require,module,exports){"use strict";function toCartesian(lat,lon,out){return out||(out=[]),lat-=90,lat*=radians,lon*=radians,out[0]=cos(lon)*sin(lat),out[1]=sin(lon)*sin(lat),out[2]=cos(lat),out}var radians=Math.PI/180,sin=Math.sin,cos=Math.cos;module.exports=toCartesian},{}],12:[function(require,module,exports){module.exports={centroids:{AUS:[.628150120418853,-.6660235327361547,-.4022935247545412],COL:[-.2958230840386079,.952048488669075,.07805368775924038],MYS:[.418116902069641,-.9061238954168378,.06416963735523001],USA:[.001727513805720677,.7852290617868861,.6192029846676593]},ranges:{AFG:[0,603],AGO:[603,1242],ALB:[1242,1422],ARE:[1422,1602],ARG:[1602,2655],ARM:[2655,2817],ATA:[2817,3582],ATF:[3582,3645],AUS:[3645,5778],AUT:[5778,6093],AZE:[6093,6453],BDI:[6453,6552],BEL:[6552,6669],BEN:[6669,6876],BFA:[6876,7209],BGD:[7209,7515],BGR:[7515,7749],BHS:[7749,7884],BIH:[7884,8064],BLR:[8064,8442],BLZ:[8442,8604],BOL:[8604,9126],BRA:[9126,10935],BRN:[10935,10989],BTN:[10989,11088],BWA:[11088,11430],CAF:[11430,11970],CAN:[11970,18549],CHE:[18549,18747],CHL:[18747,19728],CHN:[19728,21852],CIV:[21852,22248],CMR:[22248,22779],COD:[22779,23859],COG:[23859,24282],COL:[24282,25164],CRI:[25164,25470],CUB:[25470,25830],CYP:[25830,25947],CZE:[25947,26244],DEU:[26244,26748],DJI:[26748,26865],DNK:[26865,27045],DOM:[27045,27261],DZA:[27261,27801],ECU:[27801,28080],EGY:[28080,28440],ERI:[28440,28674],ESP:[28674,29115],EST:[29115,29250],ETH:[29250,29763],FIN:[29763,30087],FJI:[30087,30222],FLK:[30222,30294],FRA:[30294,30906],GAB:[30906,31167],GBR:[31167,31626],GEO:[31626,31824],GHA:[31824,32031],GIN:[32031,32643],GMB:[32643,32769],GNB:[32769,32922],GNQ:[32922,32967],GRC:[32967,33417],GRL:[33417,34587],GTM:[34587,34884],GUY:[34884,35226],HND:[35226,35721],HRV:[35721,36081],HTI:[36081,36252],HUN:[36252,36513],IDN:[36513,38529],IND:[38529,39735],IRL:[39735,39834],IRN:[39834,40491],IRQ:[40491,40743],ISL:[40743,40905],ISR:[40905,41094],ITA:[41094,41823],JAM:[41823,41904],JOR:[41904,42057],JPN:[42057,42588],KAZ:[42588,43578],KEN:[43578,43893],KGZ:[43893,44190],KHM:[44190,44325],KOR:[44325,44478],KWT:[44478,44541],LAO:[44541,44856],LBN:[44856,44937],LBR:[44937,45162],LBY:[45162,45648],LKA:[45648,45720],LSO:[45720,45810],LTU:[45810,45963],LUX:[45963,46008],LVA:[46008,46188],MAR:[46188,46728],MDA:[46728,46953],MDG:[46953,47376],MEX:[47376,48888],MKD:[48888,49023],MLI:[49023,49689],MMR:[49689,50301],MNE:[50301,50445],MNG:[50445,51102],MOZ:[51102,51777],MRT:[51777,52110],MWI:[52110,52344],MYS:[52344,52866],NAM:[52866,53244],NCL:[53244,53343],NER:[53343,53847],NGA:[53847,54351],NIC:[54351,54801],NLD:[54801,54909],NOR:[54909,55629],NPL:[55629,55818],NZL:[55818,56376],OMN:[56376,56763],PAK:[56763,57339],PAN:[57339,57789],PER:[57789,58455],PHL:[58455,59319],PNG:[59319,59976],POL:[59976,60363],PRI:[60363,60426],PRK:[60426,60795],PRT:[60795,61074],PRY:[61074,61353],PSE:[61353,61416],QAT:[61416,61479],ROU:[61479,61857],RUS:[61857,62784],RWA:[62784,62883],ESH:[62883,63108],SAU:[63108,63774],SDN:[63774,64467],SSD:[64467,65016],SEN:[65016,65394],SLB:[65394,65637],SLE:[65637,65817],SLV:[65817,65979],SOM:[65979,66285],SRB:[66285,66681],SUR:[66681,66897],SVK:[66897,67176],SVN:[67176,67320],SWE:[67320,67662],SWZ:[67662,67743],SYR:[67743,67968],TCD:[67968,68472],TGO:[68472,68625],THA:[68625,69183],TJK:[69183,69534],TKM:[69534,70002],TLS:[70002,70083],TTO:[70083,70137],TUN:[70137,70398],TUR:[70398,70965],TWN:[70965,71028],TZA:[71028,71451],UGA:[71451,71676],UKR:[71676,72540],URY:[72540,72711],USA:[72711,76518],UZB:[76518,76986],VEN:[76986,77796],VNM:[77796,78174],VUT:[78174,78246],YEM:[78246,78624],ZAF:[78624,79344],ZMB:[79344,79875],ZWE:[79875,80190]},index:{AUS:8,COL:35,MYS:109,USA:165}}},{}],13:[function(require,module,exports){"use strict";function expandRanges(ranges,index,size){var output=new Float32Array(size),j=1e3;return Object.keys(ranges).forEach(function(name){for(var start=ranges[name][0]/3,end=ranges[name][1]/3,id=index[name]||(index[name]=j++),i=start;end>i;i++)output[i]=id}),output}function getScreenPosition(el){for(var top=el.offsetTop,left=el.offsetLeft;el.offsetParent&&(top+=el.offsetParent.offsetTop,left+=el.offsetParent.offsetLeft,el!=document.body);)el=el.offsetParent;return[left,top]}var _prototypeProperties=function(child,staticProps,instanceProps){staticProps&&Object.defineProperties(child,staticProps),instanceProps&&Object.defineProperties(child.prototype,instanceProps)},_inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(subClass.__proto__=superClass)},_classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},rotations=require("./rotations"),Symbol=(require("class-list"),require("es6-symbol")),shaders=require("./shaders"),glBuffer=require("gl-buffer"),mat4=(require("inherits"),require("gl-mat4")),Emitter=require("events/"),glVAO=require("gl-vao");module.exports=function(gl,opts){return new Globe(gl,opts)};var ELEMENT_DATA=Symbol("globe element data"),TAU=2*Math.PI,START=Date.now(),Globe=(mat4.create(),function(Emitter){function Globe(gl){var opts=void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,Globe);var positions=opts.positions,ranges=expandRanges(opts.ranges,opts.index,positions.length),canvas=gl.canvas;this.gl=gl,this.index=opts.index,this.canvas=canvas,this.country="USA",this.selected=null,this.targets=[],this.targetData=[],this.teamTarget=new Float32Array(2),canvas.style.position="fixed",this.shaders={},this.shaders.globe=shaders.globe(gl),this.shaders.pointer=shaders.pointer(gl),this.offset=new Float32Array([-1.5,-.5,-2.5]),this.position=new Float32Array(3),this.rotation=new Float32Array(3),this.projection=mat4.create(),this.view=mat4.create(),this.model=mat4.create(),this.mvp=mat4.create(),this.dt=0,this.lastTime=Date.now(),this.opacity=1,this.initMesh(positions,ranges),this.initPointer(),this.calculateTargetPositions()}return _inherits(Globe,Emitter),_prototypeProperties(Globe,null,{initMesh:{value:function(positions,ranges){var gl=this.gl;this.mesh=glVAO(gl,[{buffer:glBuffer(gl,positions),size:3},{buffer:glBuffer(gl,ranges),size:1}]),this.mesh.length=positions.length/3},writable:!0,configurable:!0},initPointer:{value:function(){var data=new Float32Array([0,0,.5,0,.5,1,1,1]),_ref=this,gl=_ref.gl;this.pointer=glVAO(gl,[{buffer:glBuffer(gl,data),size:2}])},writable:!0,configurable:!0},calculateTargetPositions:{value:function(){for(var list=this.targetData,targets=this.targets,i=0;i<targets.length;i++){var p=getScreenPosition(targets[i]);targets[i][ELEMENT_DATA]=list[i]={x:p[0],y:p[1],el:targets[i]}}list.sort(function(a,b){return a.y-b.y})},writable:!0,configurable:!0},selectElement:{value:function(element){this.selected!==element&&(element[ELEMENT_DATA]||(this.targets.push(element),this.calculateTargetPositions()),this.selected=element,this.emit("change:selected",this.selected))},writable:!0,configurable:!0},render:{value:function(){var gl=this.gl,width=gl.drawingBufferWidth,height=gl.drawingBufferHeight;this.dt=-(this.lastTime-(this.lastTime=Date.now()));for(var scroll=window.scrollY,i=0;i<this.targetData.length;i++){var item=this.targetData[i];if(item.y>scroll+100){this.selectElement(this.targetData[i].el);break}}if(this.opacity){if(this.selected){var px=(this.selected[ELEMENT_DATA].x+32)/width,py=(this.selected[ELEMENT_DATA].y+32-Math.max(0,scroll))/height;this.teamTarget[0]=2*(px-.5),this.teamTarget[1]=-2*(py-.5)}var rotationGoal=rotations[this.country];rotationGoal?(this.rotation[0]+=.07*(rotationGoal[0]-this.rotation[0]),this.rotation[1]+=.07*(rotationGoal[1]-this.rotation[1]),this.rotation[2]+=.07*(rotationGoal[2]-this.rotation[2])):(this.rotation[0]+=112345e-9*this.dt,this.rotation[1]+=152443e-9*this.dt,this.rotation[2]+=107321e-9*this.dt),this.rotation[0]%=TAU,this.rotation[1]%=TAU,this.rotation[2]%=TAU,mat4.identity(this.model),mat4.rotateX(this.model,this.model,this.rotation[0]),mat4.rotateY(this.model,this.model,this.rotation[1]),mat4.rotateZ(this.model,this.model,this.rotation[2]),mat4.identity(this.view),mat4.translate(this.view,this.view,this.offset),mat4.perspective(this.projection,Math.PI/4,width/height,.001,1e3),mat4.multiply(this.mvp,this.projection,this.view),mat4.multiply(this.mvp,this.mvp,this.model),gl.enable(gl.DEPTH_TEST),gl.disable(gl.CULL_FACE),gl.viewport(0,0,width,height);var shader=this.shaders.globe;shader.bind(),shader.attributes.aPosition.location=0,shader.attributes.aCountryIndex.location=1,shader.uniforms.uCountryIndex=this.index[this.country],shader.uniforms.uMVP=this.mvp,shader.uniforms.uTime=(Date.now()-START)/1e3,shader.uniforms.uOpacity=this.opacity,this.mesh.bind(),this.mesh.draw(gl.TRIANGLES,this.mesh.length);var shader=this.shaders.pointer;gl.disable(gl.DEPTH_TEST),gl.lineWidth(2),shader.bind(),shader.uniforms.uTeamMember=this.position,shader.uniforms.uTeamTarget=this.teamTarget,shader.uniforms.uMVP=this.mvp,shader.uniforms.uOpacity=this.opacity,this.pointer.bind(),this.pointer.draw(gl.POINTS,4),this.pointer.draw(gl.LINE_STRIP,4)}},writable:!0,configurable:!0},pointTo:{value:function(position){this.position[0]=position[0],this.position[1]=position[1],this.position[2]=position[2]},writable:!0,configurable:!0}}),Globe}(Emitter))},{"./rotations":100,"./shaders":101,"class-list":14,"es6-symbol":16,"events/":34,"gl-buffer":35,"gl-mat4":56,"gl-vao":98,inherits:99}],14:[function(require,module,exports){arguments[4][3][0].apply(exports,arguments)},{dup:3,indexof:15}],15:[function(require,module,exports){arguments[4][4][0].apply(exports,arguments)},{dup:4}],16:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Symbol:require("./polyfill")},{"./is-implemented":17,"./polyfill":32}],17:[function(require,module,exports){"use strict";module.exports=function(){var symbol;if("function"!=typeof Symbol)return!1;symbol=Symbol("test symbol");try{String(symbol)}catch(e){return!1}return"symbol"==typeof Symbol.iterator?!0:"object"!=typeof Symbol.isConcatSpreadable?!1:"object"!=typeof Symbol.iterator?!1:"object"!=typeof Symbol.toPrimitive?!1:"object"!=typeof Symbol.toStringTag?!1:"object"!=typeof Symbol.unscopables?!1:!0}},{}],18:[function(require,module,exports){"use strict";module.exports=function(x){return x&&("symbol"==typeof x||"Symbol"===x["@@toStringTag"])||!1}},{}],19:[function(require,module,exports){"use strict";var d,assign=require("es5-ext/object/assign"),normalizeOpts=require("es5-ext/object/normalize-options"),isCallable=require("es5-ext/object/is-callable"),contains=require("es5-ext/string/#/contains");d=module.exports=function(dscr,value){var c,e,w,options,desc;return arguments.length<2||"string"!=typeof dscr?(options=value,value=dscr,dscr=null):options=arguments[2],null==dscr?(c=w=!0,e=!1):(c=contains.call(dscr,"c"),e=contains.call(dscr,"e"),w=contains.call(dscr,"w")),desc={value:value,configurable:c,enumerable:e,writable:w},options?assign(normalizeOpts(options),desc):desc},d.gs=function(dscr,get,set){var c,e,options,desc;return"string"!=typeof dscr?(options=set,set=get,get=dscr,dscr=null):options=arguments[3],null==get?get=void 0:isCallable(get)?null==set?set=void 0:isCallable(set)||(options=set,set=void 0):(options=get,get=set=void 0),null==dscr?(c=!0,e=!1):(c=contains.call(dscr,"c"),e=contains.call(dscr,"e")),desc={get:get,set:set,configurable:c,enumerable:e},options?assign(normalizeOpts(options),desc):desc}},{"es5-ext/object/assign":20,"es5-ext/object/is-callable":23,"es5-ext/object/normalize-options":27,"es5-ext/string/#/contains":29}],20:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Object.assign:require("./shim")},{"./is-implemented":21,"./shim":22}],21:[function(require,module,exports){"use strict";module.exports=function(){var obj,assign=Object.assign;return"function"!=typeof assign?!1:(obj={foo:"raz"},assign(obj,{bar:"dwa"},{trzy:"trzy"}),obj.foo+obj.bar+obj.trzy==="razdwatrzy")}},{}],22:[function(require,module,exports){"use strict";var keys=require("../keys"),value=require("../valid-value"),max=Math.max;module.exports=function(dest,src){var error,i,assign,l=max(arguments.length,2);for(dest=Object(value(dest)),assign=function(key){try{dest[key]=src[key]}catch(e){error||(error=e)}},i=1;l>i;++i)src=arguments[i],keys(src).forEach(assign);if(void 0!==error)throw error;return dest}},{"../keys":24,"../valid-value":28}],23:[function(require,module,exports){"use strict";module.exports=function(obj){return"function"==typeof obj}},{}],24:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?Object.keys:require("./shim")},{"./is-implemented":25,"./shim":26}],25:[function(require,module,exports){"use strict";module.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],26:[function(require,module,exports){"use strict";var keys=Object.keys;module.exports=function(object){return keys(null==object?object:Object(object))}},{}],27:[function(require,module,exports){"use strict";var forEach=Array.prototype.forEach,create=Object.create,process=function(src,obj){var key;for(key in src)obj[key]=src[key]};module.exports=function(options){var result=create(null);return forEach.call(arguments,function(options){null!=options&&process(Object(options),result)}),result}},{}],28:[function(require,module,exports){"use strict";module.exports=function(value){if(null==value)throw new TypeError("Cannot use null or undefined");return value}},{}],29:[function(require,module,exports){"use strict";module.exports=require("./is-implemented")()?String.prototype.contains:require("./shim")},{"./is-implemented":30,"./shim":31}],30:[function(require,module,exports){"use strict";var str="razdwatrzy";module.exports=function(){return"function"!=typeof str.contains?!1:str.contains("dwa")===!0&&str.contains("foo")===!1}},{}],31:[function(require,module,exports){"use strict";var indexOf=String.prototype.indexOf;module.exports=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1}},{}],32:[function(require,module,exports){"use strict";var Symbol,HiddenSymbol,d=require("d"),validateSymbol=require("./validate-symbol"),create=Object.create,defineProperties=Object.defineProperties,defineProperty=Object.defineProperty,objPrototype=Object.prototype,globalSymbols=create(null),generateName=function(){
var created=create(null);return function(desc){for(var name,postfix=0;created[desc+(postfix||"")];)++postfix;return desc+=postfix||"",created[desc]=!0,name="@@"+desc,defineProperty(objPrototype,name,d.gs(null,function(value){defineProperty(this,name,d(value))})),name}}();HiddenSymbol=function Symbol(description){if(this instanceof HiddenSymbol)throw new TypeError("TypeError: Symbol is not a constructor");return Symbol(description)},module.exports=Symbol=function Symbol(description){var symbol;if(this instanceof Symbol)throw new TypeError("TypeError: Symbol is not a constructor");return symbol=create(HiddenSymbol.prototype),description=void 0===description?"":String(description),defineProperties(symbol,{__description__:d("",description),__name__:d("",generateName(description))})},defineProperties(Symbol,{"for":d(function(key){return globalSymbols[key]?globalSymbols[key]:globalSymbols[key]=Symbol(String(key))}),keyFor:d(function(s){var key;validateSymbol(s);for(key in globalSymbols)if(globalSymbols[key]===s)return key}),hasInstance:d("",Symbol("hasInstance")),isConcatSpreadable:d("",Symbol("isConcatSpreadable")),iterator:d("",Symbol("iterator")),match:d("",Symbol("match")),replace:d("",Symbol("replace")),search:d("",Symbol("search")),species:d("",Symbol("species")),split:d("",Symbol("split")),toPrimitive:d("",Symbol("toPrimitive")),toStringTag:d("",Symbol("toStringTag")),unscopables:d("",Symbol("unscopables"))}),defineProperties(HiddenSymbol.prototype,{constructor:d(Symbol),toString:d("",function(){return this.__name__})}),defineProperties(Symbol.prototype,{toString:d(function(){return"Symbol ("+validateSymbol(this).__description__+")"}),valueOf:d(function(){return validateSymbol(this)})}),defineProperty(Symbol.prototype,Symbol.toPrimitive,d("",function(){return validateSymbol(this)})),defineProperty(Symbol.prototype,Symbol.toStringTag,d("c","Symbol")),defineProperty(HiddenSymbol.prototype,Symbol.toPrimitive,d("c",Symbol.prototype[Symbol.toPrimitive])),defineProperty(HiddenSymbol.prototype,Symbol.toStringTag,d("c",Symbol.prototype[Symbol.toStringTag]))},{"./validate-symbol":33,d:19}],33:[function(require,module,exports){"use strict";var isSymbol=require("./is-symbol");module.exports=function(value){if(!isSymbol(value))throw new TypeError(value+" is not a symbol");return value}},{"./is-symbol":18}],34:[function(require,module,exports){arguments[4][7][0].apply(exports,arguments)},{dup:7}],35:[function(require,module,exports){"use strict";function GLBuffer(gl,type,handle,length,usage){this.gl=gl,this.type=type,this.handle=handle,this.length=length,this.usage=usage}function updateTypeArray(gl,type,len,usage,data,offset){var dataLen=data.length*data.BYTES_PER_ELEMENT;if(0>offset)return gl.bufferData(type,data,usage),dataLen;if(dataLen+offset>len)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return gl.bufferSubData(type,offset,data),len}function makeScratchTypeArray(array,dtype){for(var res=pool.malloc(array.length,dtype),n=array.length,i=0;n>i;++i)res[i]=array[i];return res}function isPacked(shape,stride){for(var n=1,i=stride.length-1;i>=0;--i){if(stride[i]!==n)return!1;n*=shape[i]}return!0}function createBuffer(gl,data,type,usage){if(type=type||gl.ARRAY_BUFFER,usage=usage||gl.DYNAMIC_DRAW,type!==gl.ARRAY_BUFFER&&type!==gl.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(usage!==gl.DYNAMIC_DRAW&&usage!==gl.STATIC_DRAW&&usage!==gl.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var handle=gl.createBuffer(),result=new GLBuffer(gl,type,handle,0,usage);return result.update(data),result}var pool=require("typedarray-pool"),ops=require("ndarray-ops"),ndarray=require("ndarray"),SUPPORTED_TYPES=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],proto=GLBuffer.prototype;proto.bind=function(){this.gl.bindBuffer(this.type,this.handle)},proto.unbind=function(){this.gl.bindBuffer(this.type,null)},proto.dispose=function(){this.gl.deleteBuffer(this.handle)},proto.update=function(array,offset){if("number"!=typeof offset&&(offset=-1),this.bind(),"object"==typeof array&&"undefined"!=typeof array.shape){var dtype=array.dtype;if(SUPPORTED_TYPES.indexOf(dtype)<0&&(dtype="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var ext=gl.getExtension("OES_element_index_uint");dtype=ext&&"uint16"!==dtype?"uint32":"uint16"}if(dtype===array.dtype&&isPacked(array.shape,array.stride))0===array.offset&&array.data.length===array.shape[0]?this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data,offset):this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data.subarray(array.offset,array.shape[0]),offset);else{var tmp=pool.malloc(array.size,dtype),ndt=ndarray(tmp,array.shape);ops.assign(ndt,array),0>offset?this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,tmp,offset):this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,tmp.subarray(0,array.size),offset),pool.free(tmp)}}else if(Array.isArray(array)){var t;t=this.type===this.gl.ELEMENT_ARRAY_BUFFER?makeScratchTypeArray(array,"uint16"):makeScratchTypeArray(array,"float32"),0>offset?this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,t,offset):this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,t.subarray(0,array.length),offset),pool.free(t)}else if("object"==typeof array&&"number"==typeof array.length)this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array,offset);else{if("number"!=typeof array&&void 0!==array)throw new Error("gl-buffer: Invalid data type");if(offset>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");array=0|array,0>=array&&(array=1),this.gl.bufferData(this.type,0|array,this.usage),this.length=array}},module.exports=createBuffer},{ndarray:41,"ndarray-ops":36,"typedarray-pool":46}],36:[function(require,module,exports){"use strict";function fixup(x){if(!x)return EmptyProc;for(var i=0;i<x.args.length;++i){var a=x.args[i];0===i?x.args[i]={name:a,lvalue:!0,rvalue:!!x.rvalue,count:x.count||1}:x.args[i]={name:a,lvalue:!1,rvalue:!0,count:1}}return x.thisVars||(x.thisVars=[]),x.localVars||(x.localVars=[]),x}function pcompile(user_args){return compile({args:user_args.args,pre:fixup(user_args.pre),body:fixup(user_args.body),post:fixup(user_args.proc),funcName:user_args.funcName})}function makeOp(user_args){for(var args=[],i=0;i<user_args.args.length;++i)args.push("a"+i);var wrapper=new Function("P",["return function ",user_args.funcName,"_ndarrayops(",args.join(","),") {P(",args.join(","),");return a0}"].join(""));return wrapper(pcompile(user_args))}var compile=require("cwise-compiler"),EmptyProc={body:"",args:[],thisVars:[],localVars:[]},assign_ops={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var id in assign_ops){var op=assign_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id}),exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+op+"=b"},rvalue:!0,funcName:id+"eq"}),exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"}),exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+op+"=s"},rvalue:!0,funcName:id+"seq"})}}();var unary_ops={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var id in unary_ops){var op=unary_ops[id];exports[id]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+op+"b"},funcName:id}),exports[id+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+op+"a"},rvalue:!0,count:2,funcName:id+"eq"})}}();var binary_ops={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var id in binary_ops){var op=binary_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id}),exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"}),exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+op+"b"},rvalue:!0,count:2,funcName:id+"eq"}),exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+op+"s"},rvalue:!0,count:2,funcName:id+"seq"})}}();var math_unary=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var i=0;i<math_unary.length;++i){var f=math_unary[i];exports[f]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f}),exports[f+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"})}}();var math_comm=["max","min","atan2","pow"];!function(){for(var i=0;i<math_comm.length;++i){var f=math_comm[i];exports[f]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f}),exports[f+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"}),exports[f+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"}),exports[f+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"seq"})}}();var math_noncomm=["atan2","pow"];!function(){for(var i=0;i<math_noncomm.length;++i){var f=math_noncomm[i];exports[f+"op"]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"}),exports[f+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"}),exports[f+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opeq"}),exports[f+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opseq"})}}(),exports.any=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),exports.all=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),exports.sum=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),exports.prod=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),exports.norm2squared=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),exports.norm2=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),exports.norminf=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),exports.norm1=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),exports.sup=compile({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),exports.inf=compile({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),exports.argmin=compile({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),exports.argmax=compile({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),exports.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),exports.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),exports.assigns=makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),exports.equals=compile({args:["array","array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":37}],37:[function(require,module,exports){"use strict";function Procedure(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function compileCwise(user_args){var proc=new Procedure;proc.pre=user_args.pre,proc.body=user_args.body,proc.post=user_args.post;var proc_args=user_args.args.slice(0);proc.argTypes=proc_args;for(var i=0;i<proc_args.length;++i){var arg_type=proc_args[i];if("array"===arg_type||"object"==typeof arg_type&&arg_type.blockIndices){if(proc.argTypes[i]="array",proc.arrayArgs.push(i),proc.arrayBlockIndices.push(arg_type.blockIndices?arg_type.blockIndices:0),proc.shimArgs.push("array"+i),i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===arg_type)proc.scalarArgs.push(i),proc.shimArgs.push("scalar"+i);else if("index"===arg_type){if(proc.indexArgs.push(i),i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===arg_type){if(proc.shapeArgs.push(i),i<proc.pre.args.length&&proc.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<proc.post.args.length&&proc.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof arg_type||!arg_type.offset)throw new Error("cwise: Unknown argument type "+proc_args[i]);proc.argTypes[i]="offset",proc.offsetArgs.push({array:arg_type.array,offset:arg_type.offset}),proc.offsetArgIndex.push(i)}}if(proc.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(proc.pre.args.length>proc_args.length)throw new Error("cwise: Too many arguments in pre() block");if(proc.body.args.length>proc_args.length)throw new Error("cwise: Too many arguments in body() block");if(proc.post.args.length>proc_args.length)throw new Error("cwise: Too many arguments in post() block");return proc.debug=!!user_args.printCode||!!user_args.debug,proc.funcName=user_args.funcName||"cwise",proc.blockSize=user_args.blockSize||64,createThunk(proc)}var createThunk=require("./lib/thunk.js");module.exports=compileCwise},{"./lib/thunk.js":39}],38:[function(require,module,exports){"use strict";function innerFill(order,proc,body){var i,j,dimension=order.length,nargs=proc.arrayArgs.length,has_index=proc.indexArgs.length>0,code=[],vars=[],idx=0,pidx=0;for(i=0;dimension>i;++i)vars.push(["i",i,"=0"].join(""));for(j=0;nargs>j;++j)for(i=0;dimension>i;++i)pidx=idx,idx=order[i],0===i?vars.push(["d",j,"s",i,"=t",j,"p",idx].join("")):vars.push(["d",j,"s",i,"=(t",j,"p",idx,"-s",pidx,"*t",j,"p",pidx,")"].join(""));for(code.push("var "+vars.join(",")),i=dimension-1;i>=0;--i)idx=order[i],code.push(["for(i",i,"=0;i",i,"<s",idx,";++i",i,"){"].join(""));for(code.push(body),i=0;dimension>i;++i){for(pidx=idx,idx=order[i],j=0;nargs>j;++j)code.push(["p",j,"+=d",j,"s",i].join(""));has_index&&(i>0&&code.push(["index[",pidx,"]-=s",pidx].join("")),code.push(["++index[",idx,"]"].join(""))),code.push("}")}return code.join("\n")}function outerFill(matched,order,proc,body){for(var dimension=order.length,nargs=proc.arrayArgs.length,blockSize=proc.blockSize,has_index=proc.indexArgs.length>0,code=[],i=0;nargs>i;++i)code.push(["var offset",i,"=p",i].join(""));for(var i=matched;dimension>i;++i)code.push(["for(var j"+i+"=SS[",order[i],"]|0;j",i,">0;){"].join("")),code.push(["if(j",i,"<",blockSize,"){"].join("")),code.push(["s",order[i],"=j",i].join("")),code.push(["j",i,"=0"].join("")),code.push(["}else{s",order[i],"=",blockSize].join("")),code.push(["j",i,"-=",blockSize,"}"].join("")),has_index&&code.push(["index[",order[i],"]=j",i].join(""));for(var i=0;nargs>i;++i){for(var indexStr=["offset"+i],j=matched;dimension>j;++j)indexStr.push(["j",j,"*t",i,"p",order[j]].join(""));code.push(["p",i,"=(",indexStr.join("+"),")"].join(""))}code.push(innerFill(order,proc,body));for(var i=matched;dimension>i;++i)code.push("}");return code.join("\n")}function countMatches(orders){for(var matched=0,dimension=orders[0].length;dimension>matched;){for(var j=1;j<orders.length;++j)if(orders[j][matched]!==orders[0][matched])return matched;++matched}return matched}function processBlock(block,proc,dtypes){for(var code=block.body,pre=[],post=[],i=0;i<block.args.length;++i){var carg=block.args[i];if(!(carg.count<=0)){var re=new RegExp(carg.name,"g"),ptrStr="",arrNum=proc.arrayArgs.indexOf(i);switch(proc.argTypes[i]){case"offset":var offArgIndex=proc.offsetArgIndex.indexOf(i),offArg=proc.offsetArgs[offArgIndex];arrNum=offArg.array,ptrStr="+q"+offArgIndex;case"array":ptrStr="p"+arrNum+ptrStr;var localStr="l"+i,arrStr="a"+arrNum;if(0===proc.arrayBlockIndices[arrNum])1===carg.count?"generic"===dtypes[arrNum]?carg.lvalue?(pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join("")),code=code.replace(re,localStr),post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))):code=code.replace(re,[arrStr,".get(",ptrStr,")"].join("")):code=code.replace(re,[arrStr,"[",ptrStr,"]"].join("")):"generic"===dtypes[arrNum]?(pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join("")),code=code.replace(re,localStr),carg.lvalue&&post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))):(pre.push(["var ",localStr,"=",arrStr,"[",ptrStr,"]"].join("")),code=code.replace(re,localStr),carg.lvalue&&post.push([arrStr,"[",ptrStr,"]=",localStr].join("")));else{for(var reStrArr=[carg.name],ptrStrArr=[ptrStr],j=0;j<Math.abs(proc.arrayBlockIndices[arrNum]);j++)reStrArr.push("\\s*\\[([^\\]]+)\\]"),ptrStrArr.push("$"+(j+1)+"*t"+arrNum+"b"+j);if(re=new RegExp(reStrArr.join(""),"g"),ptrStr=ptrStrArr.join("+"),"generic"===dtypes[arrNum])throw new Error("cwise: Generic arrays not supported in combination with blocks!");code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}break;case"scalar":code=code.replace(re,"Y"+proc.scalarArgs.indexOf(i));break;case"index":code=code.replace(re,"index");break;case"shape":code=code.replace(re,"shape")}}}return[pre.join("\n"),code,post.join("\n")].join("\n").trim()}function typeSummary(dtypes){for(var summary=new Array(dtypes.length),allEqual=!0,i=0;i<dtypes.length;++i){var t=dtypes[i],digits=t.match(/\d+/);digits=digits?digits[0]:"",0===t.charAt(0)?summary[i]="u"+t.charAt(1)+digits:summary[i]=t.charAt(0)+digits,i>0&&(allEqual=allEqual&&summary[i]===summary[i-1])}return allEqual?summary[0]:summary.join("")}function generateCWiseOp(proc,typesig){for(var dimension=typesig[1].length-Math.abs(proc.arrayBlockIndices[0])|0,orders=new Array(proc.arrayArgs.length),dtypes=new Array(proc.arrayArgs.length),i=0;i<proc.arrayArgs.length;++i)dtypes[i]=typesig[2*i],orders[i]=typesig[2*i+1];for(var blockBegin=[],blockEnd=[],loopBegin=[],loopEnd=[],loopOrders=[],i=0;i<proc.arrayArgs.length;++i){proc.arrayBlockIndices[i]<0?(loopBegin.push(0),loopEnd.push(dimension),blockBegin.push(dimension),blockEnd.push(dimension+proc.arrayBlockIndices[i])):(loopBegin.push(proc.arrayBlockIndices[i]),loopEnd.push(proc.arrayBlockIndices[i]+dimension),blockBegin.push(0),blockEnd.push(proc.arrayBlockIndices[i]));for(var newOrder=[],j=0;j<orders[i].length;j++)loopBegin[i]<=orders[i][j]&&orders[i][j]<loopEnd[i]&&newOrder.push(orders[i][j]-loopBegin[i]);loopOrders.push(newOrder)}for(var arglist=["SS"],code=["'use strict'"],vars=[],j=0;dimension>j;++j)vars.push(["s",j,"=SS[",j,"]"].join(""));for(var i=0;i<proc.arrayArgs.length;++i){arglist.push("a"+i),arglist.push("t"+i),arglist.push("p"+i);for(var j=0;dimension>j;++j)vars.push(["t",i,"p",j,"=t",i,"[",loopBegin[i]+j,"]"].join(""));for(var j=0;j<Math.abs(proc.arrayBlockIndices[i]);++j)vars.push(["t",i,"b",j,"=t",i,"[",blockBegin[i]+j,"]"].join(""))}for(var i=0;i<proc.scalarArgs.length;++i)arglist.push("Y"+i);if(proc.shapeArgs.length>0&&vars.push("shape=SS.slice(0)"),proc.indexArgs.length>0){for(var zeros=new Array(dimension),i=0;dimension>i;++i)zeros[i]="0";vars.push(["index=[",zeros.join(","),"]"].join(""))}for(var i=0;i<proc.offsetArgs.length;++i){for(var off_arg=proc.offsetArgs[i],init_string=[],j=0;j<off_arg.offset.length;++j)0!==off_arg.offset[j]&&(1===off_arg.offset[j]?init_string.push(["t",off_arg.array,"p",j].join("")):init_string.push([off_arg.offset[j],"*t",off_arg.array,"p",j].join("")));0===init_string.length?vars.push("q"+i+"=0"):vars.push(["q",i,"=",init_string.join("+")].join(""))}var thisVars=uniq([].concat(proc.pre.thisVars).concat(proc.body.thisVars).concat(proc.post.thisVars));vars=vars.concat(thisVars),code.push("var "+vars.join(","));for(var i=0;i<proc.arrayArgs.length;++i)code.push("p"+i+"|=0");proc.pre.body.length>3&&code.push(processBlock(proc.pre,proc,dtypes));var body=processBlock(proc.body,proc,dtypes),matched=countMatches(loopOrders);dimension>matched?code.push(outerFill(matched,loopOrders[0],proc,body)):code.push(innerFill(loopOrders[0],proc,body)),proc.post.body.length>3&&code.push(processBlock(proc.post,proc,dtypes)),proc.debug&&console.log("-----Generated cwise routine for ",typesig,":\n"+code.join("\n")+"\n----------");var loopName=[proc.funcName||"unnamed","_cwise_loop_",orders[0].join("s"),"m",matched,typeSummary(dtypes)].join(""),f=new Function(["function ",loopName,"(",arglist.join(","),"){",code.join("\n"),"} return ",loopName].join(""));return f()}var uniq=require("uniq");module.exports=generateCWiseOp},{uniq:40}],39:[function(require,module,exports){"use strict";function createThunk(proc){var code=["'use strict'","var CACHED={}"],vars=[],thunkName=proc.funcName+"_cwise_thunk";code.push(["return function ",thunkName,"(",proc.shimArgs.join(","),"){"].join(""));for(var typesig=[],string_typesig=[],proc_args=[["array",proc.arrayArgs[0],".shape.slice(",Math.max(0,proc.arrayBlockIndices[0]),proc.arrayBlockIndices[0]<0?","+proc.arrayBlockIndices[0]+")":")"].join("")],shapeLengthConditions=[],shapeConditions=[],i=0;i<proc.arrayArgs.length;++i){var j=proc.arrayArgs[i];vars.push(["t",j,"=array",j,".dtype,","r",j,"=array",j,".order"].join("")),typesig.push("t"+j),typesig.push("r"+j),string_typesig.push("t"+j),string_typesig.push("r"+j+".join()"),proc_args.push("array"+j+".data"),proc_args.push("array"+j+".stride"),proc_args.push("array"+j+".offset|0"),i>0&&(shapeLengthConditions.push("array"+proc.arrayArgs[0]+".shape.length===array"+j+".shape.length+"+(Math.abs(proc.arrayBlockIndices[0])-Math.abs(proc.arrayBlockIndices[i]))),shapeConditions.push("array"+proc.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[0])+"]===array"+j+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[i])+"]"))}proc.arrayArgs.length>1&&(code.push("if (!("+shapeLengthConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),code.push("for(var shapeIndex=array"+proc.arrayArgs[0]+".shape.length-"+Math.abs(proc.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),code.push("if (!("+shapeConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),code.push("}"));for(var i=0;i<proc.scalarArgs.length;++i)proc_args.push("scalar"+proc.scalarArgs[i]);vars.push(["type=[",string_typesig.join(","),"].join()"].join("")),vars.push("proc=CACHED[type]"),code.push("var "+vars.join(",")),code.push(["if(!proc){","CACHED[type]=proc=compile([",typesig.join(","),"])}","return proc(",proc_args.join(","),")}"].join("")),proc.debug&&console.log("-----Generated thunk:\n"+code.join("\n")+"\n----------");var thunk=new Function("compile",code.join("\n"));return thunk(compile.bind(void 0,proc))}var compile=require("./compile.js");module.exports=createThunk},{"./compile.js":38}],40:[function(require,module,exports){"use strict";function unique_pred(list,compare){for(var ptr=1,len=list.length,a=list[0],b=list[0],i=1;len>i;++i)if(b=a,a=list[i],compare(a,b)){if(i===ptr){ptr++;continue}list[ptr++]=a}return list.length=ptr,list}function unique_eq(list){for(var ptr=1,len=list.length,a=list[0],b=list[0],i=1;len>i;++i,b=a)if(b=a,a=list[i],a!==b){if(i===ptr){ptr++;continue}list[ptr++]=a}return list.length=ptr,list}function unique(list,compare,sorted){return 0===list.length?list:compare?(sorted||list.sort(compare),unique_pred(list,compare)):(sorted||list.sort(),unique_eq(list))}module.exports=unique},{}],41:[function(require,module,exports){function compare1st(a,b){return a[0]-b[0]}function order(){var i,stride=this.stride,terms=new Array(stride.length);for(i=0;i<terms.length;++i)terms[i]=[Math.abs(stride[i]),i];terms.sort(compare1st);var result=new Array(terms.length);for(i=0;i<result.length;++i)result[i]=terms[i][1];return result}function compileConstructor(dtype,dimension){var className=["View",dimension,"d",dtype].join("");0>dimension&&(className="View_Nil"+dtype);var useGetters="generic"===dtype;if(-1===dimension){var code="function "+className+"(a){this.data=a;};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+className+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+className+"(a){return new "+className+"(a);}",procedure=new Function(code);return procedure()}if(0===dimension){var code="function "+className+"(a,d) {this.data = a;this.offset = d};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+className+"_copy() {return new "+className+"(this.data,this.offset)};proto.pick=function "+className+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+className+"_get(){return "+(useGetters?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+className+"_set(v){return "+(useGetters?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+className+"(a,b,c,d){return new "+className+"(a,d)}",procedure=new Function("TrivialArray",code);return procedure(CACHED_CONSTRUCTORS[dtype][0])}var code=["'use strict'"],indices=iota(dimension),args=indices.map(function(i){return"i"+i}),index_str="this.offset+"+indices.map(function(i){return"this.stride["+i+"]*i"+i}).join("+"),shapeArg=indices.map(function(i){return"b"+i}).join(","),strideArg=indices.map(function(i){return"c"+i}).join(",");code.push("function "+className+"(a,"+shapeArg+","+strideArg+",d){this.data=a","this.shape=["+shapeArg+"]","this.stride=["+strideArg+"]","this.offset=d|0}","var proto="+className+".prototype","proto.dtype='"+dtype+"'","proto.dimension="+dimension),code.push("Object.defineProperty(proto,'size',{get:function "+className+"_size(){return "+indices.map(function(i){return"this.shape["+i+"]"}).join("*"),"}})"),1===dimension?code.push("proto.order=[0]"):(code.push("Object.defineProperty(proto,'order',{get:"),4>dimension?(code.push("function "+className+"_order(){"),2===dimension?code.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===dimension&&code.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):code.push("ORDER})")),code.push("proto.set=function "+className+"_set("+args.join(",")+",v){"),
useGetters?code.push("return this.data.set("+index_str+",v)}"):code.push("return this.data["+index_str+"]=v}"),code.push("proto.get=function "+className+"_get("+args.join(",")+"){"),useGetters?code.push("return this.data.get("+index_str+")}"):code.push("return this.data["+index_str+"]}"),code.push("proto.index=function "+className+"_index(",args.join(),"){return "+index_str+"}"),code.push("proto.hi=function "+className+"_hi("+args.join(",")+"){return new "+className+"(this.data,"+indices.map(function(i){return["(typeof i",i,"!=='number'||i",i,"<0)?this.shape[",i,"]:i",i,"|0"].join("")}).join(",")+","+indices.map(function(i){return"this.stride["+i+"]"}).join(",")+",this.offset)}");var a_vars=indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}),c_vars=indices.map(function(i){return"c"+i+"=this.stride["+i+"]"});code.push("proto.lo=function "+className+"_lo("+args.join(",")+"){var b=this.offset,d=0,"+a_vars.join(",")+","+c_vars.join(","));for(var i=0;dimension>i;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){d=i"+i+"|0;b+=c"+i+"*d;a"+i+"-=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"c"+i}).join(",")+",b)}"),code.push("proto.step=function "+className+"_step("+args.join(",")+"){var "+indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}).join(",")+","+indices.map(function(i){return"b"+i+"=this.stride["+i+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var i=0;dimension>i;++i)code.push("if(typeof i"+i+"==='number'){d=i"+i+"|0;if(d<0){c+=b"+i+"*(a"+i+"-1);a"+i+"=ceil(-a"+i+"/d)}else{a"+i+"=ceil(a"+i+"/d)}b"+i+"*=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"b"+i}).join(",")+",c)}");for(var tShape=new Array(dimension),tStride=new Array(dimension),i=0;dimension>i;++i)tShape[i]="a[i"+i+"]",tStride[i]="b[i"+i+"]";code.push("proto.transpose=function "+className+"_transpose("+args+"){"+args.map(function(n,idx){return n+"=("+n+"===undefined?"+idx+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+className+"(this.data,"+tShape.join(",")+","+tStride.join(",")+",this.offset)}"),code.push("proto.pick=function "+className+"_pick("+args+"){var a=[],b=[],c=this.offset");for(var i=0;dimension>i;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){c=(c+this.stride["+i+"]*i"+i+")|0}else{a.push(this.shape["+i+"]);b.push(this.stride["+i+"])}");code.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),code.push("return function construct_"+className+"(data,shape,stride,offset){return new "+className+"(data,"+indices.map(function(i){return"shape["+i+"]"}).join(",")+","+indices.map(function(i){return"stride["+i+"]"}).join(",")+",offset)}");var procedure=new Function("CTOR_LIST","ORDER",code.join("\n"));return procedure(CACHED_CONSTRUCTORS[dtype],order)}function arrayDType(data){if(isBuffer(data))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(data)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(data)?"array":"generic"}function wrappedNDArrayCtor(data,shape,stride,offset){if(void 0===data){var ctor=CACHED_CONSTRUCTORS.array[0];return ctor([])}"number"==typeof data&&(data=[data]),void 0===shape&&(shape=[data.length]);var d=shape.length;if(void 0===stride){stride=new Array(d);for(var i=d-1,sz=1;i>=0;--i)stride[i]=sz,sz*=shape[i]}if(void 0===offset){offset=0;for(var i=0;d>i;++i)stride[i]<0&&(offset-=(shape[i]-1)*stride[i])}for(var dtype=arrayDType(data),ctor_list=CACHED_CONSTRUCTORS[dtype];ctor_list.length<=d+1;)ctor_list.push(compileConstructor(dtype,ctor_list.length-1));var ctor=ctor_list[d+1];return ctor(data,shape,stride,offset)}var iota=require("iota-array"),isBuffer=require("is-buffer"),hasTypedArrays="undefined"!=typeof Float64Array,CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};module.exports=wrappedNDArrayCtor},{"iota-array":42,"is-buffer":43}],42:[function(require,module,exports){"use strict";function iota(n){for(var result=new Array(n),i=0;n>i;++i)result[i]=i;return result}module.exports=iota},{}],43:[function(require,module,exports){module.exports=function(obj){return!(null==obj||!(obj._isBuffer||obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)))}},{}],44:[function(require,module,exports){"use strict";"use restrict";function countTrailingZeros(v){var c=32;return v&=-v,v&&c--,65535&v&&(c-=16),16711935&v&&(c-=8),252645135&v&&(c-=4),858993459&v&&(c-=2),1431655765&v&&(c-=1),c}var INT_BITS=32;exports.INT_BITS=INT_BITS,exports.INT_MAX=2147483647,exports.INT_MIN=-1<<INT_BITS-1,exports.sign=function(v){return(v>0)-(0>v)},exports.abs=function(v){var mask=v>>INT_BITS-1;return(v^mask)-mask},exports.min=function(x,y){return y^(x^y)&-(y>x)},exports.max=function(x,y){return x^(x^y)&-(y>x)},exports.isPow2=function(v){return!(v&v-1||!v)},exports.log2=function(v){var r,shift;return r=(v>65535)<<4,v>>>=r,shift=(v>255)<<3,v>>>=shift,r|=shift,shift=(v>15)<<2,v>>>=shift,r|=shift,shift=(v>3)<<1,v>>>=shift,r|=shift,r|v>>1},exports.log10=function(v){return v>=1e9?9:v>=1e8?8:v>=1e7?7:v>=1e6?6:v>=1e5?5:v>=1e4?4:v>=1e3?3:v>=100?2:v>=10?1:0},exports.popCount=function(v){return v-=v>>>1&1431655765,v=(858993459&v)+(v>>>2&858993459),16843009*(v+(v>>>4)&252645135)>>>24},exports.countTrailingZeros=countTrailingZeros,exports.nextPow2=function(v){return v+=0===v,--v,v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,v|=v>>>16,v+1},exports.prevPow2=function(v){return v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,v|=v>>>16,v-(v>>>1)},exports.parity=function(v){return v^=v>>>16,v^=v>>>8,v^=v>>>4,v&=15,27030>>>v&1};var REVERSE_TABLE=new Array(256);!function(tab){for(var i=0;256>i;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1)r<<=1,r|=1&v,--s;tab[i]=r<<s&255}}(REVERSE_TABLE),exports.reverse=function(v){return REVERSE_TABLE[255&v]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]},exports.interleave2=function(x,y){return x&=65535,x=16711935&(x|x<<8),x=252645135&(x|x<<4),x=858993459&(x|x<<2),x=1431655765&(x|x<<1),y&=65535,y=16711935&(y|y<<8),y=252645135&(y|y<<4),y=858993459&(y|y<<2),y=1431655765&(y|y<<1),x|y<<1},exports.deinterleave2=function(v,n){return v=v>>>n&1431655765,v=858993459&(v|v>>>1),v=252645135&(v|v>>>2),v=16711935&(v|v>>>4),v=65535&(v|v>>>16),v<<16>>16},exports.interleave3=function(x,y,z){return x&=1023,x=4278190335&(x|x<<16),x=251719695&(x|x<<8),x=3272356035&(x|x<<4),x=1227133513&(x|x<<2),y&=1023,y=4278190335&(y|y<<16),y=251719695&(y|y<<8),y=3272356035&(y|y<<4),y=1227133513&(y|y<<2),x|=y<<1,z&=1023,z=4278190335&(z|z<<16),z=251719695&(z|z<<8),z=3272356035&(z|z<<4),z=1227133513&(z|z<<2),x|z<<2},exports.deinterleave3=function(v,n){return v=v>>>n&1227133513,v=3272356035&(v|v>>>2),v=251719695&(v|v>>>4),v=4278190335&(v|v>>>8),v=1023&(v|v>>>16),v<<22>>22},exports.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>countTrailingZeros(v)+1}},{}],45:[function(require,module,exports){"use strict";function dupe_array(count,value,i){var c=0|count[i];if(0>=c)return[];var j,result=new Array(c);if(i===count.length-1)for(j=0;c>j;++j)result[j]=value;else for(j=0;c>j;++j)result[j]=dupe_array(count,value,i+1);return result}function dupe_number(count,value){var result,i;for(result=new Array(count),i=0;count>i;++i)result[i]=value;return result}function dupe(count,value){switch("undefined"==typeof value&&(value=0),typeof count){case"number":if(count>0)return dupe_number(0|count,value);break;case"object":if("number"==typeof count.length)return dupe_array(count,value,0)}return[]}module.exports=dupe},{}],46:[function(require,module,exports){(function(global,Buffer){"use strict";function freeArrayBuffer(buffer){if(buffer){var n=buffer.length||buffer.byteLength,log_n=bits.log2(n);DATA[log_n].push(buffer)}}function freeTypedArray(array){freeArrayBuffer(array.buffer)}function mallocArrayBuffer(n){var n=bits.nextPow2(n),log_n=bits.log2(n),d=DATA[log_n];return d.length>0?d.pop():new ArrayBuffer(n)}function mallocUint8(n){return new Uint8Array(mallocArrayBuffer(n),0,n)}function mallocUint16(n){return new Uint16Array(mallocArrayBuffer(2*n),0,n)}function mallocUint32(n){return new Uint32Array(mallocArrayBuffer(4*n),0,n)}function mallocInt8(n){return new Int8Array(mallocArrayBuffer(n),0,n)}function mallocInt16(n){return new Int16Array(mallocArrayBuffer(2*n),0,n)}function mallocInt32(n){return new Int32Array(mallocArrayBuffer(4*n),0,n)}function mallocFloat(n){return new Float32Array(mallocArrayBuffer(4*n),0,n)}function mallocDouble(n){return new Float64Array(mallocArrayBuffer(8*n),0,n)}function mallocUint8Clamped(n){return hasUint8C?new Uint8ClampedArray(mallocArrayBuffer(n),0,n):mallocUint8(n)}function mallocDataView(n){return new DataView(mallocArrayBuffer(n),0,n)}function mallocBuffer(n){n=bits.nextPow2(n);var log_n=bits.log2(n),cache=BUFFER[log_n];return cache.length>0?cache.pop():new Buffer(n)}var bits=require("bit-twiddle"),dup=require("dup");global.__TYPEDARRAY_POOL||(global.__TYPEDARRAY_POOL={UINT8:dup([32,0]),UINT16:dup([32,0]),UINT32:dup([32,0]),INT8:dup([32,0]),INT16:dup([32,0]),INT32:dup([32,0]),FLOAT:dup([32,0]),DOUBLE:dup([32,0]),DATA:dup([32,0]),UINT8C:dup([32,0]),BUFFER:dup([32,0])});var hasUint8C="undefined"!=typeof Uint8ClampedArray,POOL=global.__TYPEDARRAY_POOL;POOL.UINT8C||(POOL.UINT8C=dup([32,0])),POOL.BUFFER||(POOL.BUFFER=dup([32,0]));var DATA=POOL.DATA,BUFFER=POOL.BUFFER;exports.free=function(array){if(Buffer.isBuffer(array))BUFFER[bits.log2(array.length)].push(array);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(array)&&(array=array.buffer),!array)return;var n=array.length||array.byteLength,log_n=0|bits.log2(n);DATA[log_n].push(array)}},exports.freeUint8=exports.freeUint16=exports.freeUint32=exports.freeInt8=exports.freeInt16=exports.freeInt32=exports.freeFloat32=exports.freeFloat=exports.freeFloat64=exports.freeDouble=exports.freeUint8Clamped=exports.freeDataView=freeTypedArray,exports.freeArrayBuffer=freeArrayBuffer,exports.freeBuffer=function(array){BUFFER[bits.log2(array.length)].push(array)},exports.malloc=function(n,dtype){if(void 0===dtype||"arraybuffer"===dtype)return mallocArrayBuffer(n);switch(dtype){case"uint8":return mallocUint8(n);case"uint16":return mallocUint16(n);case"uint32":return mallocUint32(n);case"int8":return mallocInt8(n);case"int16":return mallocInt16(n);case"int32":return mallocInt32(n);case"float":case"float32":return mallocFloat(n);case"double":case"float64":return mallocDouble(n);case"uint8_clamped":return mallocUint8Clamped(n);case"buffer":return mallocBuffer(n);case"data":case"dataview":return mallocDataView(n);default:return null}return null},exports.mallocArrayBuffer=mallocArrayBuffer,exports.mallocUint8=mallocUint8,exports.mallocUint16=mallocUint16,exports.mallocUint32=mallocUint32,exports.mallocInt8=mallocInt8,exports.mallocInt16=mallocInt16,exports.mallocInt32=mallocInt32,exports.mallocFloat32=exports.mallocFloat=mallocFloat,exports.mallocFloat64=exports.mallocDouble=mallocDouble,exports.mallocUint8Clamped=mallocUint8Clamped,exports.mallocDataView=mallocDataView,exports.mallocBuffer=mallocBuffer,exports.clearCache=function(){for(var i=0;32>i;++i)POOL.UINT8[i].length=0,POOL.UINT16[i].length=0,POOL.UINT32[i].length=0,POOL.INT8[i].length=0,POOL.INT16[i].length=0,POOL.INT32[i].length=0,POOL.FLOAT[i].length=0,POOL.DOUBLE[i].length=0,POOL.UINT8C[i].length=0,DATA[i].length=0,BUFFER[i].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"bit-twiddle":44,buffer:112,dup:45}],47:[function(require,module,exports){function adjoint(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];return out[0]=a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22),out[1]=-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22)),out[2]=a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12),out[3]=-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12)),out[4]=-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22)),out[5]=a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22),out[6]=-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12)),out[7]=a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12),out[8]=a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21),out[9]=-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21)),out[10]=a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11),out[11]=-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11)),out[12]=-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21)),out[13]=a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21),out[14]=-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11)),out[15]=a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11),out}module.exports=adjoint},{}],48:[function(require,module,exports){function clone(a){var out=new Float32Array(16);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out}module.exports=clone},{}],49:[function(require,module,exports){function copy(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out}module.exports=copy},{}],50:[function(require,module,exports){function create(){var out=new Float32Array(16);return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}module.exports=create},{}],51:[function(require,module,exports){function determinant(a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32;return b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06}module.exports=determinant},{}],52:[function(require,module,exports){function fromQuat(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-yy-zz,out[1]=yx+wz,out[2]=zx-wy,out[3]=0,out[4]=yx-wz,out[5]=1-xx-zz,out[6]=zy+wx,out[7]=0,out[8]=zx+wy,out[9]=zy-wx,out[10]=1-xx-yy,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}module.exports=fromQuat},{}],53:[function(require,module,exports){function fromRotationTranslation(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-(yy+zz),out[1]=xy+wz,out[2]=xz-wy,out[3]=0,out[4]=xy-wz,out[5]=1-(xx+zz),out[6]=yz+wx,out[7]=0,out[8]=xz+wy,out[9]=yz-wx,out[10]=1-(xx+yy),out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out}module.exports=fromRotationTranslation},{}],54:[function(require,module,exports){function frustum(out,left,right,bottom,top,near,far){var rl=1/(right-left),tb=1/(top-bottom),nf=1/(near-far);return out[0]=2*near*rl,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=2*near*tb,out[6]=0,out[7]=0,out[8]=(right+left)*rl,out[9]=(top+bottom)*tb,out[10]=(far+near)*nf,out[11]=-1,out[12]=0,out[13]=0,out[14]=far*near*2*nf,out[15]=0,out}module.exports=frustum},{}],55:[function(require,module,exports){function identity(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}module.exports=identity},{}],56:[function(require,module,exports){module.exports={create:require("./create"),clone:require("./clone"),copy:require("./copy"),identity:require("./identity"),transpose:require("./transpose"),invert:require("./invert"),adjoint:require("./adjoint"),determinant:require("./determinant"),multiply:require("./multiply"),translate:require("./translate"),scale:require("./scale"),rotate:require("./rotate"),rotateX:require("./rotateX"),rotateY:require("./rotateY"),rotateZ:require("./rotateZ"),fromRotationTranslation:require("./fromRotationTranslation"),fromQuat:require("./fromQuat"),frustum:require("./frustum"),perspective:require("./perspective"),perspectiveFromFieldOfView:require("./perspectiveFromFieldOfView"),ortho:require("./ortho"),lookAt:require("./lookAt"),str:require("./str")}},{"./adjoint":47,"./clone":48,"./copy":49,"./create":50,"./determinant":51,"./fromQuat":52,"./fromRotationTranslation":53,"./frustum":54,"./identity":55,"./invert":57,"./lookAt":58,"./multiply":59,"./ortho":60,"./perspective":61,"./perspectiveFromFieldOfView":62,"./rotate":63,"./rotateX":64,"./rotateY":65,"./rotateZ":66,"./scale":67,"./str":68,"./translate":69,"./transpose":70}],57:[function(require,module,exports){function invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?(det=1/det,out[0]=(a11*b11-a12*b10+a13*b09)*det,out[1]=(a02*b10-a01*b11-a03*b09)*det,out[2]=(a31*b05-a32*b04+a33*b03)*det,out[3]=(a22*b04-a21*b05-a23*b03)*det,out[4]=(a12*b08-a10*b11-a13*b07)*det,out[5]=(a00*b11-a02*b08+a03*b07)*det,out[6]=(a32*b02-a30*b05-a33*b01)*det,out[7]=(a20*b05-a22*b02+a23*b01)*det,out[8]=(a10*b10-a11*b08+a13*b06)*det,out[9]=(a01*b08-a00*b10-a03*b06)*det,out[10]=(a30*b04-a31*b02+a33*b00)*det,out[11]=(a21*b02-a20*b04-a23*b00)*det,out[12]=(a11*b07-a10*b09-a12*b06)*det,out[13]=(a00*b09-a01*b07+a02*b06)*det,out[14]=(a31*b01-a30*b03-a32*b00)*det,out[15]=(a20*b03-a21*b01+a22*b00)*det,out):null}module.exports=invert},{}],58:[function(require,module,exports){function lookAt(out,eye,center,up){var x0,x1,x2,y0,y1,y2,z0,z1,z2,len,eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],centerx=center[0],centery=center[1],centerz=center[2];return Math.abs(eyex-centerx)<1e-6&&Math.abs(eyey-centery)<1e-6&&Math.abs(eyez-centerz)<1e-6?identity(out):(z0=eyex-centerx,z1=eyey-centery,z2=eyez-centerz,len=1/Math.sqrt(z0*z0+z1*z1+z2*z2),z0*=len,z1*=len,z2*=len,x0=upy*z2-upz*z1,x1=upz*z0-upx*z2,x2=upx*z1-upy*z0,len=Math.sqrt(x0*x0+x1*x1+x2*x2),len?(len=1/len,x0*=len,x1*=len,x2*=len):(x0=0,x1=0,x2=0),y0=z1*x2-z2*x1,y1=z2*x0-z0*x2,y2=z0*x1-z1*x0,len=Math.sqrt(y0*y0+y1*y1+y2*y2),len?(len=1/len,y0*=len,y1*=len,y2*=len):(y0=0,y1=0,y2=0),out[0]=x0,out[1]=y0,out[2]=z0,out[3]=0,out[4]=x1,out[5]=y1,out[6]=z1,out[7]=0,out[8]=x2,out[9]=y2,out[10]=z2,out[11]=0,out[12]=-(x0*eyex+x1*eyey+x2*eyez),out[13]=-(y0*eyex+y1*eyey+y2*eyez),out[14]=-(z0*eyex+z1*eyey+z2*eyez),out[15]=1,out)}var identity=require("./identity");module.exports=lookAt},{"./identity":55}],59:[function(require,module,exports){function multiply(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return out[0]=b0*a00+b1*a10+b2*a20+b3*a30,out[1]=b0*a01+b1*a11+b2*a21+b3*a31,out[2]=b0*a02+b1*a12+b2*a22+b3*a32,out[3]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[4],b1=b[5],b2=b[6],b3=b[7],out[4]=b0*a00+b1*a10+b2*a20+b3*a30,out[5]=b0*a01+b1*a11+b2*a21+b3*a31,out[6]=b0*a02+b1*a12+b2*a22+b3*a32,out[7]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[8],b1=b[9],b2=b[10],b3=b[11],out[8]=b0*a00+b1*a10+b2*a20+b3*a30,out[9]=b0*a01+b1*a11+b2*a21+b3*a31,out[10]=b0*a02+b1*a12+b2*a22+b3*a32,out[11]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[12],b1=b[13],b2=b[14],b3=b[15],out[12]=b0*a00+b1*a10+b2*a20+b3*a30,out[13]=b0*a01+b1*a11+b2*a21+b3*a31,out[14]=b0*a02+b1*a12+b2*a22+b3*a32,out[15]=b0*a03+b1*a13+b2*a23+b3*a33,out}module.exports=multiply},{}],60:[function(require,module,exports){function ortho(out,left,right,bottom,top,near,far){var lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);return out[0]=-2*lr,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=-2*bt,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=2*nf,out[11]=0,out[12]=(left+right)*lr,out[13]=(top+bottom)*bt,out[14]=(far+near)*nf,out[15]=1,out}module.exports=ortho},{}],61:[function(require,module,exports){function perspective(out,fovy,aspect,near,far){var f=1/Math.tan(fovy/2),nf=1/(near-far);return out[0]=f/aspect,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=f,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=(far+near)*nf,out[11]=-1,out[12]=0,out[13]=0,out[14]=2*far*near*nf,out[15]=0,out}module.exports=perspective},{}],62:[function(require,module,exports){function perspectiveFromFieldOfView(out,fov,near,far){var upTan=Math.tan(fov.upDegrees*Math.PI/180),downTan=Math.tan(fov.downDegrees*Math.PI/180),leftTan=Math.tan(fov.leftDegrees*Math.PI/180),rightTan=Math.tan(fov.rightDegrees*Math.PI/180),xScale=2/(leftTan+rightTan),yScale=2/(upTan+downTan);return out[0]=xScale,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=yScale,out[6]=0,out[7]=0,out[8]=-((leftTan-rightTan)*xScale*.5),out[9]=(upTan-downTan)*yScale*.5,out[10]=far/(near-far),out[11]=-1,out[12]=0,out[13]=0,out[14]=far*near/(near-far),out[15]=0,out}module.exports=perspectiveFromFieldOfView},{}],63:[function(require,module,exports){function rotate(out,a,rad,axis){var s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22,x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z);return Math.abs(len)<1e-6?null:(len=1/len,x*=len,y*=len,z*=len,s=Math.sin(rad),c=Math.cos(rad),t=1-c,a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],b00=x*x*t+c,b01=y*x*t+z*s,b02=z*x*t-y*s,b10=x*y*t-z*s,b11=y*y*t+c,b12=z*y*t+x*s,b20=x*z*t+y*s,b21=y*z*t-x*s,b22=z*z*t+c,out[0]=a00*b00+a10*b01+a20*b02,out[1]=a01*b00+a11*b01+a21*b02,out[2]=a02*b00+a12*b01+a22*b02,out[3]=a03*b00+a13*b01+a23*b02,out[4]=a00*b10+a10*b11+a20*b12,out[5]=a01*b10+a11*b11+a21*b12,out[6]=a02*b10+a12*b11+a22*b12,out[7]=a03*b10+a13*b11+a23*b12,out[8]=a00*b20+a10*b21+a20*b22,out[9]=a01*b20+a11*b21+a21*b22,out[10]=a02*b20+a12*b21+a22*b22,out[11]=a03*b20+a13*b21+a23*b22,a!==out&&(out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out)}module.exports=rotate},{}],64:[function(require,module,exports){function rotateX(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a!==out&&(out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[4]=a10*c+a20*s,out[5]=a11*c+a21*s,out[6]=a12*c+a22*s,out[7]=a13*c+a23*s,out[8]=a20*c-a10*s,out[9]=a21*c-a11*s,out[10]=a22*c-a12*s,out[11]=a23*c-a13*s,out}module.exports=rotateX},{}],65:[function(require,module,exports){function rotateY(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a!==out&&(out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[0]=a00*c-a20*s,out[1]=a01*c-a21*s,out[2]=a02*c-a22*s,out[3]=a03*c-a23*s,out[8]=a00*s+a20*c,out[9]=a01*s+a21*c,out[10]=a02*s+a22*c,out[11]=a03*s+a23*c,out}module.exports=rotateY},{}],66:[function(require,module,exports){function rotateZ(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];return a!==out&&(out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[0]=a00*c+a10*s,out[1]=a01*c+a11*s,out[2]=a02*c+a12*s,out[3]=a03*c+a13*s,out[4]=a10*c-a00*s,out[5]=a11*c-a01*s,out[6]=a12*c-a02*s,out[7]=a13*c-a03*s,out}module.exports=rotateZ},{}],67:[function(require,module,exports){function scale(out,a,v){var x=v[0],y=v[1],z=v[2];return out[0]=a[0]*x,out[1]=a[1]*x,out[2]=a[2]*x,out[3]=a[3]*x,out[4]=a[4]*y,out[5]=a[5]*y,out[6]=a[6]*y,out[7]=a[7]*y,out[8]=a[8]*z,out[9]=a[9]*z,out[10]=a[10]*z,out[11]=a[11]*z,out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out}module.exports=scale},{}],68:[function(require,module,exports){function str(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}module.exports=str},{}],69:[function(require,module,exports){function translate(out,a,v){var a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,x=v[0],y=v[1],z=v[2];return a===out?(out[12]=a[0]*x+a[4]*y+a[8]*z+a[12],out[13]=a[1]*x+a[5]*y+a[9]*z+a[13],out[14]=a[2]*x+a[6]*y+a[10]*z+a[14],out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]):(a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],out[0]=a00,out[1]=a01,out[2]=a02,out[3]=a03,out[4]=a10,out[5]=a11,out[6]=a12,out[7]=a13,out[8]=a20,out[9]=a21,out[10]=a22,out[11]=a23,out[12]=a00*x+a10*y+a20*z+a[12],out[13]=a01*x+a11*y+a21*z+a[13],out[14]=a02*x+a12*y+a22*z+a[14],out[15]=a03*x+a13*y+a23*z+a[15]),out}module.exports=translate},{}],70:[function(require,module,exports){function transpose(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a01,out[6]=a[9],out[7]=a[13],out[8]=a02,out[9]=a12,out[11]=a[14],out[12]=a03,out[13]=a13,out[14]=a23}else out[0]=a[0],out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a[1],out[5]=a[5],out[6]=a[9],out[7]=a[13],out[8]=a[2],out[9]=a[6],out[10]=a[10],out[11]=a[14],out[12]=a[3],out[13]=a[7],out[14]=a[11],out[15]=a[15];return out}module.exports=transpose},{}],71:[function(require,module,exports){"use strict";function Shader(gl){this.gl=gl,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function compareAttributes(a,b){return a.name<b.name?-1:1}function createShader(gl,vertSource,fragSource,uniforms,attributes){var shader=new Shader(gl);return shader.update(vertSource,fragSource,uniforms,attributes),shader}var createUniformWrapper=require("./lib/create-uniforms"),createAttributeWrapper=require("./lib/create-attributes"),makeReflect=require("./lib/reflect"),shaderCache=require("./lib/shader-cache"),runtime=require("./lib/runtime-reflect"),GLError=require("./lib/GLError"),proto=Shader.prototype;proto.bind=function(){this.program||this._relink(),this.gl.useProgram(this.program)},proto.dispose=function(){this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},proto.update=function(vertSource,fragSource,uniforms,attributes){function relink(){wrapper.program=shaderCache.program(gl,wrapper._vref,wrapper._fref,attributeNames,attributeLocations);for(var i=0;i<uniforms.length;++i)uniformLocations[i]=gl.getUniformLocation(wrapper.program,uniforms[i].name)}if(!fragSource||1===arguments.length){var obj=vertSource;vertSource=obj.vertex,fragSource=obj.fragment,uniforms=obj.uniforms,attributes=obj.attributes}var wrapper=this,gl=wrapper.gl,pvref=wrapper._vref;wrapper._vref=shaderCache.shader(gl,gl.VERTEX_SHADER,vertSource),pvref&&pvref.dispose(),wrapper.vertShader=wrapper._vref.shader;var pfref=this._fref;if(wrapper._fref=shaderCache.shader(gl,gl.FRAGMENT_SHADER,fragSource),pfref&&pfref.dispose(),wrapper.fragShader=wrapper._fref.shader,!uniforms||!attributes){var testProgram=gl.createProgram();if(gl.attachShader(testProgram,wrapper.fragShader),gl.attachShader(testProgram,wrapper.vertShader),gl.linkProgram(testProgram),!gl.getProgramParameter(testProgram,gl.LINK_STATUS)){var errLog=gl.getProgramInfoLog(testProgram);throw new GLError(errLog,"Error linking program:"+errLog)}uniforms=uniforms||runtime.uniforms(gl,testProgram),attributes=attributes||runtime.attributes(gl,testProgram),gl.deleteProgram(testProgram)}attributes=attributes.slice(),attributes.sort(compareAttributes);for(var attributeUnpacked=[],attributeNames=[],attributeLocations=[],i=0;i<attributes.length;++i){var attr=attributes[i];if(attr.type.indexOf("mat")>=0){for(var size=0|attr.type.charAt(attr.type.length-1),locVector=new Array(size),j=0;size>j;++j)locVector[j]=attributeLocations.length,attributeNames.push(attr.name+"["+j+"]"),"number"==typeof attr.location?attributeLocations.push(attr.location+j):Array.isArray(attr.location)&&attr.location.length===size&&"number"==typeof attr.location[j]?attributeLocations.push(0|attr.location[j]):attributeLocations.push(-1);attributeUnpacked.push({name:attr.name,type:attr.type,locations:locVector})}else attributeUnpacked.push({name:attr.name,type:attr.type,locations:[attributeLocations.length]}),attributeNames.push(attr.name),"number"==typeof attr.location?attributeLocations.push(0|attr.location):attributeLocations.push(-1)}for(var curLocation=0,i=0;i<attributeLocations.length;++i)if(attributeLocations[i]<0){for(;attributeLocations.indexOf(curLocation)>=0;)curLocation+=1;attributeLocations[i]=curLocation}var uniformLocations=new Array(uniforms.length);relink(),wrapper._relink=relink,wrapper.types={uniforms:makeReflect(uniforms),attributes:makeReflect(attributes)},wrapper.attributes=createAttributeWrapper(gl,wrapper,attributeUnpacked,attributeLocations),Object.defineProperty(wrapper,"uniforms",createUniformWrapper(gl,wrapper,uniforms,uniformLocations))},module.exports=createShader},{"./lib/GLError":72,"./lib/create-attributes":73,"./lib/create-uniforms":74,"./lib/reflect":75,"./lib/runtime-reflect":76,"./lib/shader-cache":77}],72:[function(require,module,exports){function GLError(rawError,shortMessage,longMessage){this.shortMessage=shortMessage||"",this.longMessage=longMessage||"",this.rawError=rawError||"",this.message="gl-shader: "+(shortMessage||rawError||"")+(longMessage?"\n"+longMessage:""),this.stack=(new Error).stack}GLError.prototype=new Error,GLError.prototype.name="GLError",GLError.prototype.constructor=GLError,module.exports=GLError},{}],73:[function(require,module,exports){"use strict";function ShaderAttribute(gl,wrapper,index,locations,dimension,constFunc){this._gl=gl,this._wrapper=wrapper,this._index=index,this._locations=locations,this._dimension=dimension,this._constFunc=constFunc}function addVectorAttribute(gl,wrapper,index,locations,dimension,obj,name){for(var constFuncArgs=["gl","v"],varNames=[],i=0;dimension>i;++i)constFuncArgs.push("x"+i),varNames.push("x"+i);constFuncArgs.push("if(x0.length===void 0){return gl.vertexAttrib"+dimension+"f(v,"+varNames.join()+")}else{return gl.vertexAttrib"+dimension+"fv(v,x0)}");var constFunc=Function.apply(null,constFuncArgs),attr=new ShaderAttribute(gl,wrapper,index,locations,dimension,constFunc);Object.defineProperty(obj,name,{set:function(x){return gl.disableVertexAttribArray(locations[index]),constFunc(gl,locations[index],x),x},get:function(){return attr},enumerable:!0})}function addMatrixAttribute(gl,wrapper,index,locations,dimension,obj,name){for(var parts=new Array(dimension),attrs=new Array(dimension),i=0;dimension>i;++i)addVectorAttribute(gl,wrapper,index[i],locations,dimension,parts,i),attrs[i]=parts[i];Object.defineProperty(parts,"location",{
set:function(v){if(Array.isArray(v))for(var i=0;dimension>i;++i)attrs[i].location=v[i];else for(var i=0;dimension>i;++i)attrs[i].location=v+i;return v},get:function(){for(var result=new Array(dimension),i=0;dimension>i;++i)result[i]=locations[index[i]];return result},enumerable:!0}),parts.pointer=function(type,normalized,stride,offset){type=type||gl.FLOAT,normalized=!!normalized,stride=stride||dimension*dimension,offset=offset||0;for(var i=0;dimension>i;++i){var location=locations[index[i]];gl.vertexAttribPointer(location,dimension,type,normalized,stride,offset+i*dimension),gl.enableVertexAttribArray(location)}};var scratch=new Array(dimension),vertexAttrib=gl["vertexAttrib"+dimension+"fv"];Object.defineProperty(obj,name,{set:function(x){for(var i=0;dimension>i;++i){var loc=locations[index[i]];if(gl.disableVertexAttribArray(loc),Array.isArray(x[0]))vertexAttrib.call(gl,loc,x[i]);else{for(var j=0;dimension>j;++j)scratch[j]=x[dimension*i+j];vertexAttrib.call(gl,loc,scratch)}}return x},get:function(){return parts},enumerable:!0})}function createAttributeWrapper(gl,wrapper,attributes,locations){for(var obj={},i=0,n=attributes.length;n>i;++i){var a=attributes[i],name=a.name,type=a.type,locs=a.locations;switch(type){case"bool":case"int":case"float":addVectorAttribute(gl,wrapper,locs[0],locations,1,obj,name);break;default:if(type.indexOf("vec")>=0){var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new GLError("","Invalid data type for attribute "+name+": "+type);addVectorAttribute(gl,wrapper,locs[0],locations,d,obj,name)}else{if(!(type.indexOf("mat")>=0))throw new GLError("","Unknown data type for attribute "+name+": "+type);var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new GLError("","Invalid data type for attribute "+name+": "+type);addMatrixAttribute(gl,wrapper,locs,locations,d,obj,name)}}}return obj}module.exports=createAttributeWrapper;var GLError=require("./GLError"),proto=ShaderAttribute.prototype;proto.pointer=function(type,normalized,stride,offset){var self=this,gl=self._gl,location=self._locations[self._index];gl.vertexAttribPointer(location,self._dimension,type||gl.FLOAT,!!normalized,stride||0,offset||0),gl.enableVertexAttribArray(location)},proto.set=function(x0,x1,x2,x3){return this._constFunc(this._locations[this._index],x0,x1,x2,x3)},Object.defineProperty(proto,"location",{get:function(){return this._locations[this._index]},set:function(v){return v!==this._locations[this._index]&&(this._locations[this._index]=0|v,this._wrapper.program=null),0|v}})},{"./GLError":72}],74:[function(require,module,exports){"use strict";function identity(x){var c=new Function("y","return function(){return y}");return c(x)}function makeVector(length,fill){for(var result=new Array(length),i=0;length>i;++i)result[i]=fill;return result}function createUniformWrapper(gl,wrapper,uniforms,locations){function makeGetter(index){var proc=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+index+"])}");return proc(gl,wrapper,locations)}function makePropSetter(path,index,type){switch(type){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+index+"],obj"+path+")";case"float":return"gl.uniform1f(locations["+index+"],obj"+path+")";default:var vidx=type.indexOf("vec");if(!(vidx>=0&&1>=vidx&&type.length===4+vidx)){if(0===type.indexOf("mat")&&4===type.length){var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new GLError("","Invalid uniform dimension type for matrix "+name+": "+type);return"gl.uniformMatrix"+d+"fv(locations["+index+"],false,obj"+path+")"}throw new GLError("","Unknown uniform data type for "+name+": "+type)}var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new GLError("","Invalid data type");switch(type.charAt(0)){case"b":case"i":return"gl.uniform"+d+"iv(locations["+index+"],obj"+path+")";case"v":return"gl.uniform"+d+"fv(locations["+index+"],obj"+path+")";default:throw new GLError("","Unrecognized data type for vector "+name+": "+type)}}}function enumerateIndices(prefix,type){if("object"!=typeof type)return[[prefix,type]];var indices=[];for(var id in type){var prop=type[id],tprefix=prefix;tprefix+=parseInt(id)+""===id?"["+id+"]":"."+id,"object"==typeof prop?indices.push.apply(indices,enumerateIndices(tprefix,prop)):indices.push([tprefix,prop])}return indices}function makeSetter(type){for(var code=["return function updateProperty(obj){"],indices=enumerateIndices("",type),i=0;i<indices.length;++i){var item=indices[i],path=item[0],idx=item[1];locations[idx]&&code.push(makePropSetter(path,idx,uniforms[idx].type))}code.push("return obj}");var proc=new Function("gl","locations",code.join("\n"));return proc(gl,locations)}function defaultValue(type){switch(type){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var vidx=type.indexOf("vec");if(vidx>=0&&1>=vidx&&type.length===4+vidx){var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new GLError("","Invalid data type");return"b"===type.charAt(0)?makeVector(d,!1):makeVector(d,0)}if(0===type.indexOf("mat")&&4===type.length){var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new GLError("","Invalid uniform dimension type for matrix "+name+": "+type);return makeVector(d*d,0)}throw new GLError("","Unknown uniform data type for "+name+": "+type)}}function storeProperty(obj,prop,type){if("object"==typeof type){var child=processObject(type);Object.defineProperty(obj,prop,{get:identity(child),set:makeSetter(type),enumerable:!0,configurable:!1})}else locations[type]?Object.defineProperty(obj,prop,{get:makeGetter(type),set:makeSetter(type),enumerable:!0,configurable:!1}):obj[prop]=defaultValue(uniforms[type].type)}function processObject(obj){var result;if(Array.isArray(obj)){result=new Array(obj.length);for(var i=0;i<obj.length;++i)storeProperty(result,i,obj[i])}else{result={};for(var id in obj)storeProperty(result,id,obj[id])}return result}var coallesced=coallesceUniforms(uniforms,!0);return{get:identity(processObject(coallesced)),set:makeSetter(coallesced),enumerable:!0,configurable:!0}}var coallesceUniforms=require("./reflect"),GLError=require("./GLError");module.exports=createUniformWrapper},{"./GLError":72,"./reflect":75}],75:[function(require,module,exports){"use strict";function makeReflectTypes(uniforms,useIndex){for(var obj={},i=0;i<uniforms.length;++i)for(var n=uniforms[i].name,parts=n.split("."),o=obj,j=0;j<parts.length;++j){var x=parts[j].split("[");if(x.length>1){x[0]in o||(o[x[0]]=[]),o=o[x[0]];for(var k=1;k<x.length;++k){var y=parseInt(x[k]);k<x.length-1||j<parts.length-1?(y in o||(k<x.length-1?o[y]=[]:o[y]={}),o=o[y]):useIndex?o[y]=i:o[y]=uniforms[i].type}}else j<parts.length-1?(x[0]in o||(o[x[0]]={}),o=o[x[0]]):useIndex?o[x[0]]=i:o[x[0]]=uniforms[i].type}return obj}module.exports=makeReflectTypes},{}],76:[function(require,module,exports){"use strict";function getType(gl,type){if(!GL_TABLE){var typeNames=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var i=0;i<typeNames.length;++i){var tn=typeNames[i];GL_TABLE[gl[tn]]=GL_TO_GLSL_TYPES[tn]}}return GL_TABLE[type]}function runtimeUniforms(gl,program){for(var numUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),result=[],i=0;numUniforms>i;++i){var info=gl.getActiveUniform(program,i);if(info){var type=getType(gl,info.type);if(info.size>1)for(var j=0;j<info.size;++j)result.push({name:info.name.replace("[0]","["+j+"]"),type:type});else result.push({name:info.name,type:type})}}return result}function runtimeAttributes(gl,program){for(var numAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),result=[],i=0;numAttributes>i;++i){var info=gl.getActiveAttrib(program,i);info&&result.push({name:info.name,type:getType(gl,info.type)})}return result}exports.uniforms=runtimeUniforms,exports.attributes=runtimeAttributes;var GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},GL_TABLE=null},{}],77:[function(require,module,exports){"use strict";function ShaderReference(id,src,type,shader,programs,count,cache){this.id=id,this.src=src,this.type=type,this.shader=shader,this.count=count,this.programs=[],this.cache=cache}function ContextCache(gl){this.gl=gl,this.shaders=[{},{}],this.programs={}}function compileShader(gl,type,src){var shader=gl.createShader(type);if(gl.shaderSource(shader,src),gl.compileShader(shader),!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){var errLog=gl.getShaderInfoLog(shader);try{var fmt=formatCompilerError(errLog,src,type)}catch(e){throw console.warn("Failed to format compiler error: "+e),new GLError(errLog,"Error compiling shader:\n"+errLog)}throw new GLError(errLog,fmt["short"],fmt["long"])}return shader}function linkProgram(gl,vshader,fshader,attribs,locations){var program=gl.createProgram();gl.attachShader(program,vshader),gl.attachShader(program,fshader);for(var i=0;i<attribs.length;++i)gl.bindAttribLocation(program,locations[i],attribs[i]);if(gl.linkProgram(program),!gl.getProgramParameter(program,gl.LINK_STATUS)){var errLog=gl.getProgramInfoLog(program);throw new GLError(errLog,"Error linking program: "+errLog)}return program}function getCache(gl){var ctxCache=CACHE.get(gl);return ctxCache||(ctxCache=new ContextCache(gl),CACHE.set(gl,ctxCache)),ctxCache}function getShaderReference(gl,type,src){return getCache(gl).getShaderReference(type,src)}function createProgram(gl,vref,fref,attribs,locations){return getCache(gl).getProgram(vref,fref,attribs,locations)}exports.shader=getShaderReference,exports.program=createProgram;var GLError=require("./GLError"),formatCompilerError=require("gl-format-compiler-error"),weakMap="undefined"==typeof WeakMap?require("weakmap-shim"):WeakMap,CACHE=new weakMap,SHADER_COUNTER=0;ShaderReference.prototype.dispose=function(){if(0===--this.count){for(var cache=this.cache,gl=cache.gl,programs=this.programs,i=0,n=programs.length;n>i;++i){var p=cache.programs[programs[i]];p&&(delete cache.programs[i],gl.deleteProgram(p))}gl.deleteShader(this.shader),delete cache.shaders[this.type===gl.FRAGMENT_SHADER|0][this.src]}};var proto=ContextCache.prototype;proto.getShaderReference=function(type,src){var gl=this.gl,shaders=this.shaders[type===gl.FRAGMENT_SHADER|0],shader=shaders[src];if(shader&&gl.isShader(shader.shader))shader.count+=1;else{var shaderObj=compileShader(gl,type,src);shader=shaders[src]=new ShaderReference(SHADER_COUNTER++,src,type,shaderObj,[],1,this)}return shader},proto.getProgram=function(vref,fref,attribs,locations){var token=[vref.id,fref.id,attribs.join(":"),locations.join(":")].join("@"),prog=this.programs[token];return prog&&this.gl.isProgram(prog)||(this.programs[token]=prog=linkProgram(this.gl,vref.shader,fref.shader,attribs,locations),vref.programs.push(token),fref.programs.push(token)),prog}},{"./GLError":72,"gl-format-compiler-error":78,"weakmap-shim":94}],78:[function(require,module,exports){function formatCompilerError(errLog,src,type){"use strict";var name=shaderName(src)||"of unknown name (see npm glsl-shader-name)",typeName="unknown type";void 0!==type&&(typeName=type===glConstants.FRAGMENT_SHADER?"fragment":"vertex");for(var longForm=sprintf("Error compiling %s shader %s:\n",typeName,name),shortForm=sprintf("%s%s",longForm,errLog),errorStrings=errLog.split("\n"),errors={},i=0;i<errorStrings.length;i++){var errorString=errorStrings[i];if(""!==errorString){var lineNo=parseInt(errorString.split(":")[2]);if(isNaN(lineNo))throw new Error(sprintf("Could not parse error: %s",errorString));errors[lineNo]=errorString}}for(var lines=addLineNumbers(src).split("\n"),i=0;i<lines.length;i++)if(errors[i+3]||errors[i+2]||errors[i+1]){var line=lines[i];if(longForm+=line+"\n",errors[i+1]){var e=errors[i+1];e=e.substr(e.split(":",3).join(":").length+1).trim(),longForm+=sprintf("^^^ %s\n\n",e)}}return{"long":longForm.trim(),"short":shortForm.trim()}}var sprintf=require("sprintf-js").sprintf,glConstants=require("gl-constants/lookup"),shaderName=require("glsl-shader-name"),addLineNumbers=require("add-line-numbers");module.exports=formatCompilerError},{"add-line-numbers":79,"gl-constants/lookup":83,"glsl-shader-name":84,"sprintf-js":91}],79:[function(require,module,exports){function addLineNumbers(string,start,delim){start="number"==typeof start?start:1,delim=delim||": ";var lines=string.split(/\r?\n/),totalDigits=String(lines.length+start-1).length;return lines.map(function(line,i){var c=i+start,digits=String(c).length,prefix=padLeft(c,totalDigits-digits);return prefix+delim+line}).join("\n")}var padLeft=require("pad-left");module.exports=addLineNumbers},{"pad-left":80}],80:[function(require,module,exports){"use strict";var repeat=require("repeat-string");module.exports=function(str,num,ch){return ch="undefined"!=typeof ch?ch+"":" ",repeat(ch,num)+str}},{"repeat-string":81}],81:[function(require,module,exports){"use strict";function repeat(str,num){if("string"!=typeof str)throw new TypeError("repeat-string expects a string.");if(1===num)return str;if(2===num)return str+str;var max=str.length*num;for((cache!==str||"undefined"==typeof cache)&&(cache=str,res="");max>res.length&&num>0&&(1&num&&(res+=str),num>>=1);)str+=str;return res.substr(0,max)}module.exports=repeat;var cache,res=""},{}],82:[function(require,module,exports){module.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(require,module,exports){var gl10=require("./1.0/numbers");module.exports=function(number){return gl10[number]}},{"./1.0/numbers":82}],84:[function(require,module,exports){function getName(src){for(var tokens=Array.isArray(src)?src:tokenize(src),i=0;i<tokens.length;i++){var token=tokens[i];if("preprocessor"===token.type){var match=token.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(match&&match[2]){var b64=match[1],name=match[2];return(b64?atob(name):name).trim()}}}}var tokenize=require("glsl-tokenizer"),atob=require("atob-lite");module.exports=getName},{"atob-lite":85,"glsl-tokenizer":90}],85:[function(require,module,exports){module.exports=function(str){return atob(str)}},{}],86:[function(require,module,exports){function tokenize(){function token(data){data.length&&tokens.push({type:map[mode],data:data,position:start,line:line,column:col})}function write(chunk){i=0,input+=chunk,len=input.length;for(var last;c=input[i],len>i;){switch(last=i,mode){case BLOCK_COMMENT:i=block_comment();break;case LINE_COMMENT:i=line_comment();break;case PREPROCESSOR:i=preprocessor();break;case OPERATOR:i=operator();break;case INTEGER:i=integer();break;case HEX:i=hex();break;case FLOAT:i=decimal();break;case TOKEN:i=readtoken();break;case WHITESPACE:i=whitespace();break;case NORMAL:i=normal()}if(last!==i)switch(input[last]){case"\n":col=0,++line;break;default:++col}}return total+=i,input=input.slice(i),tokens}function end(chunk){return content.length&&token(content.join("")),mode=EOF,token("(eof)"),tokens}function normal(){return content=content.length?[]:content,"/"===last&&"*"===c?(start=total+i-1,mode=BLOCK_COMMENT,last=c,i+1):"/"===last&&"/"===c?(start=total+i-1,mode=LINE_COMMENT,last=c,i+1):"#"===c?(mode=PREPROCESSOR,start=total+i,i):/\s/.test(c)?(mode=WHITESPACE,start=total+i,i):(isnum=/\d/.test(c),isoperator=/[^\w_]/.test(c),start=total+i,mode=isnum?INTEGER:isoperator?OPERATOR:TOKEN,i)}function whitespace(){return/[^\s]/g.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function preprocessor(){return"\n"===c&&"\\"!==last?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function line_comment(){return preprocessor()}function block_comment(){return"/"===c&&"*"===last?(content.push(c),token(content.join("")),mode=NORMAL,i+1):(content.push(c),last=c,i+1)}function operator(){if("."===last&&/\d/.test(c))return mode=FLOAT,i;if("/"===last&&"*"===c)return mode=BLOCK_COMMENT,i;if("/"===last&&"/"===c)return mode=LINE_COMMENT,i;if("."===c&&content.length){for(;determine_operator(content););return mode=FLOAT,i}if(";"===c||")"===c||"("===c){if(content.length)for(;determine_operator(content););return token(c),mode=NORMAL,i+1}var is_composite_operator=2===content.length&&"="!==c;if(/[\w_\d\s]/.test(c)||is_composite_operator){for(;determine_operator(content););return mode=NORMAL,i}return content.push(c),last=c,i+1}function determine_operator(buf){for(var idx,res,j=0;;){if(idx=operators.indexOf(buf.slice(0,buf.length+j).join("")),res=operators[idx],-1===idx){if(j--+buf.length>0)continue;res=buf.slice(0,1).join("")}return token(res),start+=res.length,content=content.slice(res.length),content.length}}function hex(){return/[^a-fA-F0-9]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function integer(){return"."===c?(content.push(c),mode=FLOAT,last=c,i+1):/[eE]/.test(c)?(content.push(c),mode=FLOAT,last=c,i+1):"x"===c&&1===content.length&&"0"===content[0]?(mode=HEX,content.push(c),last=c,i+1):/[^\d]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function decimal(){return"f"===c&&(content.push(c),last=c,i+=1),/[eE]/.test(c)?(content.push(c),last=c,i+1):/[^\d]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function readtoken(){if(/[^\d\w_]/.test(c)){var contentstr=content.join("");return mode=literals.indexOf(contentstr)>-1?KEYWORD:builtins.indexOf(contentstr)>-1?BUILTIN:IDENT,token(content.join("")),mode=NORMAL,i}return content.push(c),last=c,i+1}var c,last,len,i=0,total=0,mode=NORMAL,content=[],tokens=[],line=1,col=0,start=0,isnum=!1,isoperator=!1,input="";return function(data){return tokens=[],null!==data?write(data):end()}}module.exports=tokenize;var literals=require("./lib/literals"),operators=require("./lib/operators"),builtins=require("./lib/builtins"),NORMAL=999,TOKEN=9999,BLOCK_COMMENT=0,LINE_COMMENT=1,PREPROCESSOR=2,OPERATOR=3,INTEGER=4,FLOAT=5,IDENT=6,BUILTIN=7,KEYWORD=8,WHITESPACE=9,EOF=10,HEX=11,map=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":87,"./lib/literals":88,"./lib/operators":89}],87:[function(require,module,exports){module.exports=["gl_Position","gl_PointSize","gl_ClipVertex","gl_FragCoord","gl_FrontFacing","gl_FragColor","gl_FragData","gl_FragDepth","gl_Color","gl_SecondaryColor","gl_Normal","gl_Vertex","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_FogCoord","gl_MaxLights","gl_MaxClipPlanes","gl_MaxTextureUnits","gl_MaxTextureCoords","gl_MaxVertexAttribs","gl_MaxVertexUniformComponents","gl_MaxVaryingFloats","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformComponents","gl_MaxDrawBuffers","gl_ModelViewMatrix","gl_ProjectionMatrix","gl_ModelViewProjectionMatrix","gl_TextureMatrix","gl_NormalMatrix","gl_ModelViewMatrixInverse","gl_ProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverse","gl_TextureMatrixInverse","gl_ModelViewMatrixTranspose","gl_ProjectionMatrixTranspose","gl_ModelViewProjectionMatrixTranspose","gl_TextureMatrixTranspose","gl_ModelViewMatrixInverseTranspose","gl_ProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixInverseTranspose","gl_TextureMatrixInverseTranspose","gl_NormalScale","gl_DepthRangeParameters","gl_DepthRange","gl_ClipPlane","gl_PointParameters","gl_Point","gl_MaterialParameters","gl_FrontMaterial","gl_BackMaterial","gl_LightSourceParameters","gl_LightSource","gl_LightModelParameters","gl_LightModel","gl_LightModelProducts","gl_FrontLightModelProduct","gl_BackLightModelProduct","gl_LightProducts","gl_FrontLightProduct","gl_BackLightProduct","gl_FogParameters","gl_Fog","gl_TextureEnvColor","gl_EyePlaneS","gl_EyePlaneT","gl_EyePlaneR","gl_EyePlaneQ","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_ObjectPlaneR","gl_ObjectPlaneQ","gl_FrontColor","gl_BackColor","gl_FrontSecondaryColor","gl_BackSecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_Color","gl_SecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_PointCoord","radians","degrees","sin","cos","tan","asin","acos","atan","pow","exp","log","exp2","log2","sqrt","inversesqrt","abs","sign","floor","ceil","fract","mod","min","max","clamp","mix","step","smoothstep","length","distance","dot","cross","normalize","faceforward","reflect","refract","matrixCompMult","lessThan","lessThanEqual","greaterThan","greaterThanEqual","equal","notEqual","any","all","not","texture2D","texture2DProj","texture2DLod","texture2DProjLod","textureCube","textureCubeLod","dFdx","dFdy"]},{}],88:[function(require,module,exports){module.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],89:[function(require,module,exports){module.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],90:[function(require,module,exports){function tokenizeString(str){var generator=tokenize(),tokens=[];return tokens=tokens.concat(generator(str)),tokens=tokens.concat(generator(null))}var tokenize=require("./index");module.exports=tokenizeString},{"./index":86}],91:[function(require,module,exports){!function(window){function sprintf(){var key=arguments[0],cache=sprintf.cache;return cache[key]&&cache.hasOwnProperty(key)||(cache[key]=sprintf.parse(key)),sprintf.format.call(null,cache[key],arguments)}function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}function str_repeat(input,multiplier){return Array(multiplier+1).join(input)}var re={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};sprintf.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,cursor=1,tree_length=parse_tree.length,node_type="",output=[],is_positive=!0,sign="";for(i=0;tree_length>i;i++)if(node_type=get_type(parse_tree[i]),"string"===node_type)output[output.length]=parse_tree[i];else if("array"===node_type){if(match=parse_tree[i],match[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf("[sprintf] property '%s' does not exist",match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if("function"==get_type(arg)&&(arg=arg()),re.not_string.test(match[8])&&re.not_json.test(match[8])&&"number"!=get_type(arg)&&isNaN(arg))throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)));switch(re.number.test(match[8])&&(is_positive=arg>=0),match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":case"i":arg=parseInt(arg,10);break;case"j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"g":arg=match[7]?parseFloat(arg).toPrecision(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg>>>=0;break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}re.json.test(match[8])?output[output.length]=arg:(!re.number.test(match[8])||is_positive&&!match[3]?sign="":(sign=is_positive?"+":"-",arg=arg.toString().replace(re.sign,"")),pad_character=match[4]?"0"===match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-(sign+arg).length,pad=match[6]&&pad_length>0?str_repeat(pad_character,pad_length):"",output[output.length]=match[5]?sign+arg+pad:"0"===pad_character?sign+pad+arg:pad+sign+arg)}return output.join("")},sprintf.cache={},sprintf.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=re.text.exec(_fmt)))parse_tree[parse_tree.length]=match[0];else if(null!==(match=re.modulo.exec(_fmt)))parse_tree[parse_tree.length]="%";else{if(null===(match=re.placeholder.exec(_fmt)))throw new SyntaxError("[sprintf] unexpected placeholder");
if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=re.key.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(field_list[field_list.length]=field_match[1];""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=re.key_access.exec(replacement_field)))field_list[field_list.length]=field_match[1];else{if(null===(field_match=re.index_access.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");field_list[field_list.length]=field_match[1]}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree[parse_tree.length]=match}_fmt=_fmt.substring(match[0].length)}return parse_tree};var vsprintf=function(fmt,argv,_argv){return _argv=(argv||[]).slice(0),_argv.splice(0,0,fmt),sprintf.apply(null,_argv)};"undefined"!=typeof exports?(exports.sprintf=sprintf,exports.vsprintf=vsprintf):(window.sprintf=sprintf,window.vsprintf=vsprintf,"function"==typeof define&&define.amd&&define(function(){return{sprintf:sprintf,vsprintf:vsprintf}}))}("undefined"==typeof window?this:window)},{}],92:[function(require,module,exports){function createStore(){var key={};return function(obj){if(("object"!=typeof obj||null===obj)&&"function"!=typeof obj)throw new Error("Weakmap-shim: Key must be object");var store=obj.valueOf(key);return store&&store.identity===key?store:hiddenStore(obj,key)}}var hiddenStore=require("./hidden-store.js");module.exports=createStore},{"./hidden-store.js":93}],93:[function(require,module,exports){function hiddenStore(obj,key){var store={identity:key},valueOf=obj.valueOf;return Object.defineProperty(obj,"valueOf",{value:function(value){return value!==key?valueOf.apply(this,arguments):store},writable:!0}),store}module.exports=hiddenStore},{}],94:[function(require,module,exports){function weakMap(){var privates=createStore();return{get:function(key,fallback){var store=privates(key);return store.hasOwnProperty("value")?store.value:fallback},set:function(key,value){privates(key).value=value},has:function(key){return"value"in privates(key)},"delete":function(key){return delete privates(key).value}}}var createStore=require("./create-store.js");module.exports=weakMap},{"./create-store.js":92}],95:[function(require,module,exports){"use strict";function doBind(gl,elements,attributes){elements?elements.bind():gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null);var nattribs=0|gl.getParameter(gl.MAX_VERTEX_ATTRIBS);if(attributes){if(attributes.length>nattribs)throw new Error("gl-vao: Too many vertex attributes");for(var i=0;i<attributes.length;++i){var attrib=attributes[i];if(attrib.buffer){var buffer=attrib.buffer,size=attrib.size||4,type=attrib.type||gl.FLOAT,normalized=!!attrib.normalized,stride=attrib.stride||0,offset=attrib.offset||0;buffer.bind(),gl.enableVertexAttribArray(i),gl.vertexAttribPointer(i,size,type,normalized,stride,offset)}else{if("number"==typeof attrib)gl.vertexAttrib1f(i,attrib);else if(1===attrib.length)gl.vertexAttrib1f(i,attrib[0]);else if(2===attrib.length)gl.vertexAttrib2f(i,attrib[0],attrib[1]);else if(3===attrib.length)gl.vertexAttrib3f(i,attrib[0],attrib[1],attrib[2]);else{if(4!==attrib.length)throw new Error("gl-vao: Invalid vertex attribute");gl.vertexAttrib4f(i,attrib[0],attrib[1],attrib[2],attrib[3])}gl.disableVertexAttribArray(i)}}for(;nattribs>i;++i)gl.disableVertexAttribArray(i)}else{gl.bindBuffer(gl.ARRAY_BUFFER,null);for(var i=0;nattribs>i;++i)gl.disableVertexAttribArray(i)}}module.exports=doBind},{}],96:[function(require,module,exports){"use strict";function VAOEmulated(gl){this.gl=gl,this._elements=null,this._attributes=null,this._elementsType=gl.UNSIGNED_SHORT}function createVAOEmulated(gl){return new VAOEmulated(gl)}var bindAttribs=require("./do-bind.js");VAOEmulated.prototype.bind=function(){bindAttribs(this.gl,this._elements,this._attributes)},VAOEmulated.prototype.update=function(attributes,elements,elementsType){this._elements=elements,this._attributes=attributes,this._elementsType=elementsType||this.gl.UNSIGNED_SHORT},VAOEmulated.prototype.dispose=function(){},VAOEmulated.prototype.unbind=function(){},VAOEmulated.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;this._elements?gl.drawElements(mode,count,this._elementsType,offset):gl.drawArrays(mode,offset,count)},module.exports=createVAOEmulated},{"./do-bind.js":95}],97:[function(require,module,exports){"use strict";function VertexAttribute(location,dimension,a,b,c,d){this.location=location,this.dimension=dimension,this.a=a,this.b=b,this.c=c,this.d=d}function VAONative(gl,ext,handle){this.gl=gl,this._ext=ext,this.handle=handle,this._attribs=[],this._useElements=!1,this._elementsType=gl.UNSIGNED_SHORT}function createVAONative(gl,ext){return new VAONative(gl,ext,ext.createVertexArrayOES())}var bindAttribs=require("./do-bind.js");VertexAttribute.prototype.bind=function(gl){switch(this.dimension){case 1:gl.vertexAttrib1f(this.location,this.a);break;case 2:gl.vertexAttrib2f(this.location,this.a,this.b);break;case 3:gl.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:gl.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},VAONative.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var i=0;i<this._attribs.length;++i)this._attribs[i].bind(this.gl)},VAONative.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},VAONative.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},VAONative.prototype.update=function(attributes,elements,elementsType){if(this.bind(),bindAttribs(this.gl,elements,attributes),this.unbind(),this._attribs.length=0,attributes)for(var i=0;i<attributes.length;++i){var a=attributes[i];"number"==typeof a?this._attribs.push(new VertexAttribute(i,1,a)):Array.isArray(a)&&this._attribs.push(new VertexAttribute(i,a.length,a[0],a[1],a[2],a[3]))}this._useElements=!!elements,this._elementsType=elementsType||this.gl.UNSIGNED_SHORT},VAONative.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;this._useElements?gl.drawElements(mode,count,this._elementsType,offset):gl.drawArrays(mode,offset,count)},module.exports=createVAONative},{"./do-bind.js":95}],98:[function(require,module,exports){"use strict";function createVAO(gl,attributes,elements,elementsType){var vao,ext=gl.getExtension("OES_vertex_array_object");return vao=ext?createVAONative(gl,ext):createVAOEmulated(gl),vao.update(attributes,elements,elementsType),vao}var createVAONative=require("./lib/vao-native.js"),createVAOEmulated=require("./lib/vao-emulated.js");module.exports=createVAO},{"./lib/vao-emulated.js":96,"./lib/vao-native.js":97}],99:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],100:[function(require,module,exports){module.exports={AUS:[-1.4391207668010821,-.8943297630286948,.33144999545917697],USA:[-.8943297630286948,.19525224451608025,-1.6434173932157274],NLD:[-.8943297630286948,.19525224451608025,2.646811761491824],MYS:[-1.575318517744179,-.21334100831321035,.671944372816919],COL:[1.1486365011177586,3.141592653589793,.19525224451608025],CAN:[2.025,2.6,.35]}},{}],101:[function(require,module,exports){"use strict";var Shader=require("gl-shader");exports.globe=function(gl){var vert='#define GLSLIFY 1\nprecision mediump float;\n\nattribute vec3  aPosition;\nattribute float aCountryIndex;\n\nuniform float uCountryIndex;\nuniform float uTime;\nuniform mat4  uMVP;\n\nvarying vec3  vCountryColor;\n\n//\n// GLSL textureless classic 2D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289_1_0(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x)\n{\n  return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade_1_3(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise_1_4(vec2 P)\n{\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n  Pi = mod289_1_0(Pi); // To avoid truncation effects in permutation\n  vec4 ix = Pi.xzxz;\n  vec4 iy = Pi.yyww;\n  vec4 fx = Pf.xzxz;\n  vec4 fy = Pf.yyww;\n\n  vec4 i = permute_1_1(permute_1_1(ix) + iy);\n\n  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n  vec4 gy_1_5 = abs(gx) - 0.5 ;\n  vec4 tx_1_6 = floor(gx + 0.5);\n  gx = gx - tx_1_6;\n\n  vec2 g00 = vec2(gx.x,gy_1_5.x);\n  vec2 g10 = vec2(gx.y,gy_1_5.y);\n  vec2 g01 = vec2(gx.z,gy_1_5.z);\n  vec2 g11 = vec2(gx.w,gy_1_5.w);\n\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n  g00 *= norm.x;\n  g01 *= norm.y;\n  g10 *= norm.z;\n  g11 *= norm.w;\n\n  float n00 = dot(g00, vec2(fx.x, fy.x));\n  float n10 = dot(g10, vec2(fx.y, fy.y));\n  float n01 = dot(g01, vec2(fx.z, fy.z));\n  float n11 = dot(g11, vec2(fx.w, fy.w));\n\n  vec2 fade_xy = fade_1_3(Pf.xy);\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n\n\n\n#ifndef PI\n#define PI 3.141592653589793\n#endif\n\nfloat backIn_2_7(float t) {\n  return pow(t, 3.0) - t * sin(t * PI);\n}\n\n\n\n\n#define COLOR_SELECTED vec3(0.41568627450980394,0.788235294117647,1.)\n#define COLOR_LAND vec3(0.5490196078431373,0.6235294117647059,0.5882352941176471)\n#define COLOR_GLOW vec3(0.5490196078431373,0.6235294117647059,0.5882352941176471) * 1.4\n\nvoid main() {\n  float selected = 1.0 - clamp(abs(aCountryIndex - uCountryIndex), 0.0, 1.0);\n  vec3 position = aPosition;\n\n  float glow;\n  glow = (cnoise_1_4(vec2(aCountryIndex) * 85.12219238 + uTime * 0.35) + 1.0) * 0.5;\n  glow = backIn_2_7(glow) * glow * glow;\n\n  float shade = mix(0.95, 1.075, cnoise_1_4(vec2(aCountryIndex) * 85.12219238));\n\n  vec3 color = COLOR_LAND;\n  color = mix(color, COLOR_GLOW, glow);\n  color = mix(color, COLOR_SELECTED, selected);\n  color = color * shade;\n\n  vCountryColor = color;\n\n  gl_Position = uMVP * vec4(position, 1.0);\n}\n',frag="#define GLSLIFY 1\nprecision mediump float;\n\nvarying vec3  vCountryColor;\nuniform float uCountryIndex;\nuniform float uOpacity;\n\n#define COLOR_BACKGROUND vec3(1.,1.,1.)\n\nvoid main() {\n  float backfaceFade = gl_FrontFacing ? 0.0 : 0.7;\n  float scrollFade   = clamp(1.0 - uOpacity, 0.0, 0.9);\n\n  vec3 color = vCountryColor;\n\n  color = mix(color, COLOR_BACKGROUND, backfaceFade);\n  color = mix(color, COLOR_BACKGROUND, scrollFade);\n\n  gl_FragColor = vec4(color, 1.0);\n}\n";return Shader(gl,vert,frag)},exports.pointer=function(gl){var vert="#define GLSLIFY 1\nprecision mediump float;\n\nattribute vec2 aPosition;\nuniform vec3 uTeamMember;\nuniform vec2 uTeamTarget;\nuniform mat4 uProjection;\nuniform mat4 uModel;\nuniform mat4 uView;\nuniform mat4 uMVP;\n\nvoid main() {\n  vec3 position = uTeamMember;\n  vec4 entry = uMVP * vec4(position, 1.0);\n\n  gl_PointSize = 5.0;\n  gl_Position = vec4(\n      mix(entry.xy / entry.w, uTeamTarget, aPosition.xy)\n    , 1.0\n    , 1.0\n  );\n}\n",frag="#define GLSLIFY 1\nprecision mediump float;\n\nuniform float uOpacity;\n\n#define COLOR_BACKGROUND vec3(1.,1.,1.)\n#define COLOR_POINTER vec3(0.3333333333333333,0.3333333333333333,0.3333333333333333)\n\nvoid main() {\n  gl_FragColor = vec4(mix(COLOR_BACKGROUND, COLOR_POINTER, uOpacity), 1);\n}\n";return Shader(gl,vert,frag)}},{"gl-shader":71}],102:[function(require,module,exports){"use strict";function TeamBanner(el){for(var updateDims=function(){var dims=size(el);svg.style.height=dims[0]/dims[1]*200+"%"},svg=SVG("svg"),shape=1200,y=0;shape*Y_SCALE>y;y+=IMAGE_HEIGHT)for(var x=0;shape>x;x+=IMAGE_WIDTH){var idx=Math.floor(team.length*Math.random()),nick=team[idx].nick,src="/team/"+nick+".jpg",img=SVG("image");img.setAttributeNS("http://www.w3.org/1999/xlink","href",src),img.setAttribute("width",IMAGE_WIDTH),img.setAttribute("height",IMAGE_HEIGHT),img.setAttribute("x",x),img.setAttribute("y",y),svg.appendChild(img)}svg.setAttribute("viewBox","0 0 "+shape+" "+shape*Y_SCALE),svg.style.width="100%",svg.style.position="absolute",svg.style.top="-1rem",svg.style.left=0,svg.style.zIndex=1,el.appendChild(svg),updateDims(),window.addEventListener("resize",debounce(updateDims),!1)}var SVG=require("svg-create-element"),debounce=require("frame-debounce"),size=require("element-size"),team=require("@ns/team");module.exports=TeamBanner;var IMAGE_WIDTH=96,IMAGE_HEIGHT=96,Y_SCALE=2},{"@ns/team":111,"element-size":103,"frame-debounce":104,"svg-create-element":109}],103:[function(require,module,exports){function getSize(element){if(element===window||element===document.body)return[window.innerWidth,window.innerHeight];if(!element.parentNode){var temporary=!0;document.body.appendChild(element)}var bounds=element.getBoundingClientRect(),styles=getComputedStyle(element),height=(0|bounds.height)+parse(styles.getPropertyValue("margin-top"))+parse(styles.getPropertyValue("margin-bottom")),width=(0|bounds.width)+parse(styles.getPropertyValue("margin-left"))+parse(styles.getPropertyValue("margin-right"));return temporary&&document.body.removeChild(element),[width,height]}function parse(prop){return parseFloat(prop)||0}module.exports=getSize},{}],104:[function(require,module,exports){function debounce(fn,now){function debounced(){null===args&&(args=slice(arguments),ctx=this,now&&fn.apply(ctx,args),raf(next))}function next(){now||fn.apply(ctx,args),args=null,ctx=null}var args=null,ctx=null;return debounced}var slice=require("sliced"),raf=require("raf");module.exports=debounce},{raf:105,sliced:107}],105:[function(require,module,exports){for(var now=require("performance-now"),global="undefined"==typeof window?{}:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=global["request"+suffix],caf=global["cancel"+suffix]||global["cancelRequest"+suffix],isNative=!0,i=0;i<vendors.length&&!raf;i++)raf=global[vendors[i]+"Request"+suffix],caf=global[vendors[i]+"Cancel"+suffix]||global[vendors[i]+"CancelRequest"+suffix];if(!raf||!caf){isNative=!1;var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(callback){if(0===queue.length){var _now=now(),next=Math.max(0,frameDuration-(_now-last));last=next+_now,setTimeout(function(){var cp=queue.slice(0);queue.length=0;for(var i=0;i<cp.length;i++)if(!cp[i].cancelled)try{cp[i].callback(last)}catch(e){setTimeout(function(){throw e},0)}},Math.round(next))}return queue.push({handle:++id,callback:callback,cancelled:!1}),id},caf=function(handle){for(var i=0;i<queue.length;i++)queue[i].handle===handle&&(queue[i].cancelled=!0)}}module.exports=function(fn){return isNative?raf.call(global,function(){try{fn.apply(this,arguments)}catch(e){setTimeout(function(){throw e},0)}}):raf.call(global,fn)},module.exports.cancel=function(){caf.apply(global,arguments)}},{"performance-now":106}],106:[function(require,module,exports){(function(process){(function(){var getNanoSeconds,hrtime,loadTime;"undefined"!=typeof performance&&null!==performance&&performance.now?module.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(module.exports=function(){return(getNanoSeconds()-loadTime)/1e6},hrtime=process.hrtime,getNanoSeconds=function(){var hr;return hr=hrtime(),1e9*hr[0]+hr[1]},loadTime=getNanoSeconds()):Date.now?(module.exports=function(){return Date.now()-loadTime},loadTime=Date.now()):(module.exports=function(){return(new Date).getTime()-loadTime},loadTime=(new Date).getTime())}).call(this)}).call(this,require("_process"))},{_process:116}],107:[function(require,module,exports){module.exports=exports=require("./lib/sliced")},{"./lib/sliced":108}],108:[function(require,module,exports){module.exports=function(args,slice,sliceEnd){var ret=[],len=args.length;if(0===len)return ret;var start=0>slice?Math.max(0,slice+len):slice||0;for(void 0!==sliceEnd&&(len=0>sliceEnd?sliceEnd+len:sliceEnd);len-- >start;)ret[len-start]=args[len];return ret}},{}],109:[function(require,module,exports){var has=require("has");module.exports=function(name,attr){var elem=document.createElementNS("http://www.w3.org/2000/svg",name);if(!attr)return elem;for(var key in attr)if(has(attr,key)){var nkey=key.replace(/([a-z])([A-Z])/g,function(_,a,b){return a+"-"+b.toLowerCase()});elem.setAttribute(nkey,attr[key])}return elem}},{has:110}],110:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty;module.exports=function(obj,property){return hasOwn.call(obj,property)}},{}],111:[function(require,module,exports){module.exports=[{country:"US",name:"Abi Pai",location_full:"New York, NY, USA",city:"New York City",github:"abipai",twitter:"a_pai",nick:"abi",country3:"USA",bio:"<p>Abi Pai is a Midwesterner by heart and a New Yorker by nature. Abi has always been drawn to new technology, and was intrigued by the case Node.js makes for efficient business technology on an enterprise level. At NodeSource he wears many different hats, but spends most of his day helping on a wide variety of business development initiatives. Prior to NodeSource, he worked at JPMorgan for 5+ years, most recently as an Associate in the Corporate &amp; Investment Bank.</p>\n",lat:40.71427,lon:-74.00597},{country:"US",name:"Austin Renfroe",location_full:"Austin, TX, USA",city:"Austin",state:"TX",github:"Austin519",twitter:"austin_renfroe",nick:"austin",country3:"USA",bio:"<p>Austin Renfroe has been interested in technology startups since starting a company at 11 building computers for clients. He later pursued degrees in both computer engineering, with a focus in cryptography, and mathematics, and a law degree with a focus in intellectual property. He studied IP law in Ireland and Japan, and serves as the State Bar of Texas&#39;s representative to the Japanese Patent Office Liaison Council. Austin has also served on the boards of a number of small and mid-size companies including a biotech startup, a luxury clothing firm, and a software development company and has cofounded a technology incubator and a real estate development firm. He handled complex matters for Fortune 100 companies while working in a multi-national IP and general litigation law firm, and owns his own practice that focuses on patent, copyright and trademark litigation both domestically and in the Japanese and Far East markets.</p>\n",lat:30.26715,lon:-97.74306},{country:"US",name:"Bryce Baril",location_full:"Portland, OR, USA",city:"Portland",github:"brycebaril",twitter:"brycebaril",nick:"brycebaril",country3:"USA",bio:"<p>Bryce Baril&#39;s background in science instilled in him a love for data and a passion for understanding <em>why</em> and <em>how</em> things work. When it comes to software, his least favorite phrase is &quot;I don&#39;t know, it just works.&quot; Bryce actively contributes to the Open Source community and enjoys speaking at conferences and local meetups. He is the author of a number of modules on npm including TimestreamDB -- a Node.js time-series database -- and is the current maintainer of the popular Node.js Redis client.</p>\n",lat:45.52345,lon:-122.67621},{country:"US",name:"Chip Ray",location_full:"Austin, TX, USA",city:"Austin",state:"TX",github:"frito-ray",twitter:"frito_ray",nick:"chip",country3:"USA",bio:"<p>Chip is Vice President of Product at NodeSource. He has a passion for building products that appear to defy gravity and solve tough customer problems. Chip started out building solutions for film and broadcast post-production which led him deep into the dark realms of real-time filesystems and shared storage networks. Prior to NodeSource, he led a product group at NetApp building advanced storage products for the enterprise. Chip has a love for building awesome teams which in turn create great products. All work and no play makes Chip a dull boy, so he likes to tempt fate on a slackline with his boys or wrench on his track-day Miata.</p>\n",lat:30.26715,lon:-97.74306},{country:"US",name:"Chris Lea",location_full:"Venice Beach, CA, USA",city:"Los Angeles",github:"chrislea",twitter:"chrislea",nick:"chrislea",country3:"USA",bio:"<p>Chris Lea is a technology enthusiast currently residing in sunny Southern California. He&#39;s been using Linux as his primary desktop operating environment since 1997, and actually knows what all that mess in the /proc filesystem is there for. Having spent just over a decade in various roles at (mt) Media Temple, he&#39;s a seasoned systems and performance engineer with material experience designing secure and scalable architectures. He holds a BS in Physics with Highest Honors and Distinction from UNC - Chapel Hill, and enjoys yoga, guitars and photography when he&#39;s not staring at pixels.</p>\n",lat:34.05223,lon:-118.24368},{country:"CO",name:"Daniel Aristizabal",location_full:"Medelln, Colombia",city:"Medelln",twitter:"cronopio2",github:"cronopio",nick:"cronopio",country3:"COL",bio:"<p>Daniel Aristizabal is a passionate developer with more than 10 years of experience in free and open source software and, he has been working with production grade platforms using Node.js for more than 3 years and is an advocate for JavaScript and Node.js through community events in Colombia, currently co-organizing PereiraJS and contributing to some open source projects.</p>\n",lat:6.25184,lon:-75.56359},{country:"US",name:"Dave Lutz",location_full:"Austin, TX, USA",city:"Austin",state:"TX",github:"davelutz",twitter:"lutzdave",nick:"davelutz",country3:"USA",bio:"<p>Dave is Vice President of Customer Success at NodeSource.  He has a passion for helping customers realize success across all interaction types including Services, Training, and Support.  Dave started out writing operating system software for networks and PCs at IBM.  For the last 15 years, he has led Professional Services and Support organizations at both early stage and Fortune 100 software companies.  He loves building high-performing teams and organizations that deliver extraordinary results with tremendous teamwork.  While Dave lives in a football state, his sport of choice is still college basketball and he cheers on the Tar Heels whenever they are playing.</p>\n",lat:30.26715,lon:-97.74306},{country:"US",name:"Dan Shaw",location_full:"San Francisco, CA, USA",city:"San Francisco",github:"dshaw",twitter:"dshaw",nick:"dshaw",country3:"USA",bio:"<p>Dan Shaw is a co-founder of NodeSource and is dedicated to helping improve and expand the Node Community. He is a veteran of numerous Node.js startups, including Voxer, Spreecast and Storify. Dan has extensive experience building large-scale, realtime systems with Node.js and has been building production services using Node since v0.2. Dan is a frequent speaker at Node.js, JavaScript and Realtime conferences, the host of the NodeUp podcast and the organizer of events like International NodeBots Day and the NodeBots SF meetup. Prior to Node, Dan worked in large-scale government contracts for Defense, Health Care and Education.</p>\n",lat:37.77493,lon:-122.41942},{country:"CO",name:"Adrin Estrada",location_full:"Medelln, Colombia",city:"Medelln",twitter:"edsadr",github:"edsadr",nick:"edsadr",country3:"COL",bio:"<p>Adrin Estrada is a seasoned developer with experience in multiple programming languages and has an unquenchable thirst for new technologies.  He fell in love with JavaScript and Node a couple of years ago and started helping produce community events in Colombia and is currently co-organizing MedellinJS, assisting with NodeBots, imparting NodeSchool workshops and collaborating with JSConf Colombia.</p>\n",lat:6.25184,lon:-75.56359},{country:"US",name:"Joe McCann",location_full:"San Francisco, CA, USA",city:"San Francisco",twitter:"joemccann",github:"joemccann",nick:"joemccann",country3:"USA",bio:"<p>Joe McCann is a co-founder of NodeSource. He is a hacker, tinkerer, builder and breaker with more than 13 years of web, mobile and software development experience. He has a special fondness for Node.js because he can rapidly prototype an idea within minutes. These speedy ideation sessions fed into his desire to help Fortune 500 companies build actual products that allow technology to be utilized in real world scenarios.  Joe is a frequent speaker on the conference circuit, actively promoting emerging technologies and relevant business use cases to bring pragmatism to futurism.</p>\n",lat:37.77493,lon:-122.41942},{country:"CO",name:"Julin Duque",location_full:"Medelln, Colombia",city:"Medelln",twitter:"julian_duque",github:"julianduque",nick:"julianduque",country3:"COL",bio:"<p>Julin Duque is a developer and educator by passion with more than 9 years of software development experience and working full time with Node since 2012. He organises multiple community events in Colombia like MedellinJS, NodeBots Day and JSConf Colombia. He loves sharing knowledge and is currently collaborating as evangelist in the io.js project and teaching programming fundamentals and JavaScript through NodeSchool events in Colombia and Latin America.</p>\n",lat:6.25184,lon:-75.56359},{country:"US",name:"Kevin Stewart",location_full:"Seattle, WA, USA",city:"Seattle",state:"WA",twitter:"kstewart",github:"kstewart",nick:"kstewart",country3:"USA",bio:'<p>Kevin is Vice President of Engineering at NodeSource. Previously, he was a ten-year veteran at Adobe and was one of the original engineering leaders for Creative Cloud. His team built the very first service offering, <a href="https://assets.adobe.com">Creative Cloud Assets</a> and spearheaded its migration from Ruby to Node. Prior to Adobe, Kevin has held leadership roles at multiple software companies and digital agencies where he helped shape the engineering culture by improving development and delivery practices and encouraged cross-functional teams. While currently residing in Seattle, Kevin is a lifelong New Yorker with dreams of relocating to a sunny island in the Caribbean. When he&#39;s not helping teams build great products, Kevin can be found either spending time with his family or at the gym trying to stay (get) in shape.</p>\n',lat:47.60621,lon:-122.33207},{country:"US",name:"Mark Piening",location_full:"Austin, TX, USA",city:"Austin",state:"TX",github:"markpiening",twitter:"markpiening",nick:"markpiening",country3:"USA",bio:"<p>Mark is a long time systems and data nerd in a businessperson&#39;s clothing who founded Circle Media before joining NodeSource. He was born on the left coast, lived on the right and landed in the center in ATX where tech and music thrive. Mark saw the transition from mainframe to distributed and from C to Java across 25+ years in enterprise software and systems. So he&#39;s ancient by Node standards, but young at heart. Which is why we like having him around. When Mark isn&#39;t refining business plans, managing investors, or consulting clients, he&#39;s with his family playing or watching soccer, golf, music or cramming in a little gaming with his sons (who crush him regularly at anything but Galaga).</p>\n",lat:30.26715,lon:-97.74306},{country:"US",name:"Paul DeVay",location_full:"Austin, TX, USA",city:"Austin",state:"TX",twitter:"pauldevay",github:"pdevay",nick:"pauldevay",country3:"USA",bio:"<p>Paul is a digital product designer with experience in a variety of fields from mobile to interactive physical experiences. With formal training in graphic and print design, Paul&#39;s area of focus has involved branding, print, digital strategy, design research, and most recently mobile and web creative direction and product design for a variety of startups and consultancies. Paul&#39;s interest in node.js comes from a longstanding interest in the implementation of his designs and the relative simplicity and speed of the language for front-end development.</p>\n",lat:30.26715,lon:-97.74306},{country:"US",name:"Patrick Mueller",location_full:"Raleigh, NC, USA",city:"Raleigh",github:"pmuellr",twitter:"pmuellr",nick:"pmuellr",country3:"USA",bio:"<p>Patrick is a Senior Node Engineer at NodeSource. Before that, he worked at IBM for 30 years on a diverse set of technologies: from mainframe to desktop to mobile systems, development tooling for Smalltalk, Java and JavaScript, and interludes in text editors, distributed systems, graphics libraries, natural language processing, and of course, &quot;the cloud&quot;. When not busy developing software, Patrick can often be found outside hiking, biking, or kayaking.</p>\n",lat:35.7721,lon:-78.63861},{country:"AU",name:"Rod Vagg",location_full:"Sydney, NSW, Australia",city:"Sydney",github:"rvagg",twitter:"rvagg",nick:"rvagg",country3:"AUS",bio:"<p>Rod Vagg is a strategic, multidisciplinary developer with 15 years experience in the field and serves as the Director of Engineering of NodeSource. Node.js lured him with its modularity and the productivity it affords for constructing complex and performant web applications. Rod is a strong believer in modularity as a solution to a large number of problems that plague modern application stacks. He has a keen interest in storage technologies and serves as a facilitator of the Node.js modular databases community. Rod also plays a key role in NodeSchool, a community-driven effort to create Node.js education experiences through self-driven and mentor-guided code workshops.</p>\n",lat:-33.86785,lon:151.20732},{country:"US",name:"Sara Dornsife ",location_full:"Austin, TX, USA",city:"Austin",state:"TX",twitter:"sarad",github:"nodesara",nick:"sara",country3:"USA",bio:"<p>Sara leads our marketing team at NodeSource. She brings years of experience building marketing content, programs, and events for developers and is driven to bring great open source solutions into the enterprise. Prior joining us, Sara worked on open source projects at Sun Microsystems and in developer marketing at Heroku. To break things up, Sara takes time to work out every day and really enjoys hanging out with her teenage children. She is certain they enjoy it too.</p>\n",lat:30.26715,lon:-97.74306},{country:"US",name:"Thorsten Lorenz",location_full:"New York, NY, USA",city:"New York City",github:"thlorenz",twitter:"thlorenz",nick:"thlorenz",country3:"USA",bio:"<p>Thorsten Lorenz is a Jazz musician turned developer. Initially he helped build front office trader applications for various investment banks. Then the Node.js bug bit. The fast turnaround from idea to working modules proved to be addictive and led to the creation of lots of modules which ended up on github and/or npm. Thorsten is convinced of the strong points of modular development enabled by Node.js and npm. He helped bring this approach to the browser by contributing to browserify and by creating related tools.</p>\n",lat:40.71427,lon:-74.00597},{country:"MY",name:"Tim Oxley",location_full:"Singapore",city:"Singapore",github:"timoxley",twitter:"secoif",nick:"timoxley",country3:"MYS",bio:"<p>Tim Oxley is an Australian Node.js and front-end developer currently living in Singapore. A very active member of the Open Source community, he has a passion for teaching JavaScript and Node.js. He organises the popular CampJS community conference in Australia and the SingaporeJS meetup group.</p>\n",lat:1.28967,lon:103.85007},{country:"US",name:"Elijah Insua",location_full:"New York, NY, USA",
city:"New York City",state:"NY",twitter:"tmpvar",github:"tmpvar",nick:"tmpvar",country3:"USA",bio:"<p>Elijah Insua is a JavaScript and hardware enthusiast who is a huge fan of DIY, personal manufacturing, and tactile computer interfaces. He is the creator of JSDom, which revolutionized server-side development by enabling manipulation and composition of browser content on the server. He is also the creator of npmsearch.com, which offers lightning fast searching of the npm registry with packages organized by a custom relevance rating algorithm. Elijah is also well known for in-depth visualizations to assist effective hardware implementations.</p>\n",lat:40.71427,lon:-74.00597},{country:"US",name:"Trevor Norris",location_full:"Salt Lake City, UT, USA",city:"Salt Lake City",state:"UT",github:"trevnorris",twitter:"trevnorris",nick:"trevnorris",country3:"USA",bio:"<p>Trevor Norris is a self-professed performance freak. He is a Node.js Core Contributor and is responsible for improving runtime performance and visibility. Trevor&#39;s background is in front-end development for enterprise level implementations, but now spends most of his time making JavaScript on the server blazing fast and predictable, plumbing\nthe depths of V8 and libuv, and writing C/C++. Trevor&#39;s work on benchmarking, performance tuning and optimizing Node.js have changed the face of Node.js and how developers approach serverside JavaScript.</p>\n",lat:40.76078,lon:-111.89105},{country:"US",name:"William Blankenship",location_full:"New York, NY, USA",city:"New York City",state:"NY",github:"wblankenship",twitter:"wjblankenship",nick:"wblankenship",country3:"USA",bio:"<p>Will is an Engineer at NodeSource. He is a recent college graduate with a deep desire to change the world through technology. His past shenanigans include founding a hackerspace in Southern Illinois, being the Chair of the Association of Computing Machinery at SIUC, and being the Director of the Saint Louis Area Undergraduate Research Symposium. In his spare time, he tends to write more code and attend local meetups.</p>\n",lat:40.71427,lon:-74.00597}]},{}],112:[function(require,module,exports){(function(global){"use strict";function typedArraySupport(){function Bar(){}try{var arr=new Uint8Array(1);return arr.foo=function(){return 42},arr.constructor=Bar,42===arr.foo()&&arr.constructor===Bar&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(arg){return this instanceof Buffer?(Buffer.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof arg?fromNumber(this,arg):"string"==typeof arg?fromString(this,arg,arguments.length>1?arguments[1]:"utf8"):fromObject(this,arg)):arguments.length>1?new Buffer(arg,arguments[1]):new Buffer(arg)}function fromNumber(that,length){if(that=allocate(that,0>length?0:0|checked(length)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;length>i;i++)that[i]=0;return that}function fromString(that,string,encoding){("string"!=typeof encoding||""===encoding)&&(encoding="utf8");var length=0|byteLength(string,encoding);return that=allocate(that,length),that.write(string,encoding),that}function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object);if(isArray(object))return fromArray(that,object);if(null==object)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(object.buffer instanceof ArrayBuffer)return fromTypedArray(that,object);if(object instanceof ArrayBuffer)return fromArrayBuffer(that,object)}return object.length?fromArrayLike(that,object):fromJsonObject(that,object)}function fromBuffer(that,buffer){var length=0|checked(buffer.length);return that=allocate(that,length),buffer.copy(that,0,0,length),that}function fromArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromTypedArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array){return Buffer.TYPED_ARRAY_SUPPORT?(array.byteLength,that=Buffer._augment(new Uint8Array(array))):that=fromTypedArray(that,new Uint8Array(array)),that}function fromArrayLike(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromJsonObject(that,object){var array,length=0;"Buffer"===object.type&&isArray(object.data)&&(array=object.data,length=0|checked(array.length)),that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function allocate(that,length){Buffer.TYPED_ARRAY_SUPPORT?(that=Buffer._augment(new Uint8Array(length)),that.__proto__=Buffer.prototype):(that.length=length,that._isBuffer=!0);var fromPool=0!==length&&length<=Buffer.poolSize>>>1;return fromPool&&(that.parent=rootParent),that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(subject,encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding);var buf=new Buffer(subject,encoding);return delete buf.parent,buf}function byteLength(string,encoding){"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"binary":case"raw":case"raws":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if(start=0|start,end=void 0===end||end===1/0?this.length:0|end,encoding||(encoding="utf8"),0>start&&(start=0),end>this.length&&(end=this.length),start>=end)return"";for(;;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;length>i;i++){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))throw new Error("Invalid hex string");buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;end>i;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(end>=i+bytesPerSequence){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:128>firstByte&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128===(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte,tempCodePoint>127&&(codePoint=tempCodePoint));break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128===(192&secondByte)&&128===(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte,tempCodePoint>2047&&(55296>tempCodePoint||tempCodePoint>57343)&&(codePoint=tempCodePoint));break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128===(192&secondByte)&&128===(192&thirdByte)&&128===(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte,tempCodePoint>65535&&1114112>tempCodePoint&&(codePoint=tempCodePoint))}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(MAX_ARGUMENTS_LENGTH>=len)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;len>i;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(127&buf[i]);return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||0>start)&&(start=0),(!end||0>end||end>len)&&(end=len);for(var out="",i=start;end>i;i++)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!==0||0>offset)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){0>value&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);j>i;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){0>value&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);j>i;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");if(0>offset)throw new RangeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!==0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return 16>n?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;length>i;i++){if(codePoint=string.charCodeAt(i),codePoint>55295&&57344>codePoint){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(56320>codePoint){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,128>codePoint){if((units-=1)<0)break;bytes.push(codePoint)}else if(2048>codePoint){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(65536>codePoint){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(1114112>codePoint))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;length>i&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("isarray");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT?(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array):(Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0),Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);len>i&&a[i]===b[i];)++i;return i!==len&&(x=a[i],y=b[i]),y>x?-1:x>y?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError("list argument must be an Array of Buffers.");if(0===list.length)return new Buffer(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;i++)length+=list[i].length;var buf=new Buffer(length),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.byteLength=byteLength,Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:Buffer.compare(this,b)},Buffer.prototype.indexOf=function(val,byteOffset){function arrayIndexOf(arr,val,byteOffset){for(var foundIndex=-1,i=0;byteOffset+i<arr.length;i++)if(arr[byteOffset+i]===val[-1===foundIndex?0:i-foundIndex]){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===val.length)return byteOffset+foundIndex}else foundIndex=-1;return-1}if(byteOffset>2147483647?byteOffset=2147483647:-2147483648>byteOffset&&(byteOffset=-2147483648),byteOffset>>=0,0===this.length)return-1;if(byteOffset>=this.length)return-1;if(0>byteOffset&&(byteOffset=Math.max(this.length+byteOffset,0)),"string"==typeof val)return 0===val.length?-1:String.prototype.indexOf.call(this,val,byteOffset);if(Buffer.isBuffer(val))return arrayIndexOf(this,val,byteOffset);if("number"==typeof val)return Buffer.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,val,byteOffset):arrayIndexOf(this,[val],byteOffset);throw new TypeError("val must be string, number or Buffer")},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else if(isFinite(offset))offset=0|offset,isFinite(length)?(length=0|length,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=0|length,length=swap}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(0>length||0>offset)||offset>this.length)throw new RangeError("attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"binary":return binaryWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,0>start?(start+=len,0>start&&(start=0)):start>len&&(start=len),0>end?(end+=len,0>end&&(end=0)):end>len&&(end=len),start>end&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=Buffer._augment(this.subarray(start,end));else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;sliceLen>i;i++)newBuf[i]=this[i+start]}return newBuf.length&&(newBuf.parent=this.parent||this),newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0>value?1:0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0>value?1:0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),0>value&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),0>value&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&start>end&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(0>targetStart)throw new RangeError("targetStart out of bounds");if(0>start||start>=this.length)throw new RangeError("sourceStart out of bounds");if(0>end)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&targetStart>start&&end>targetStart)for(i=len-1;i>=0;i--)target[i+targetStart]=this[i+start];else if(1e3>len||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;len>i;i++)target[i+targetStart]=this[i+start];else target._set(this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),start>end)throw new RangeError("end < start");if(end!==start&&0!==this.length){if(0>start||start>=this.length)throw new RangeError("start out of bounds");if(0>end||end>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof value)for(i=start;end>i;i++)this[i]=value;else{var bytes=utf8ToBytes(value.toString()),len=bytes.length;for(i=start;end>i;i++)this[i]=bytes[i%len]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;len>i;i+=1)buf[i]=this[i];return buf.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr.constructor=Buffer,arr._isBuffer=!0,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.equals=BP.equals,arr.compare=BP.compare,arr.indexOf=BP.indexOf,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUIntLE=BP.readUIntLE,arr.readUIntBE=BP.readUIntBE,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readIntLE=BP.readIntLE,arr.readIntBE=BP.readIntBE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUIntLE=BP.writeUIntLE,arr.writeUIntBE=BP.writeUIntBE,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeIntLE=BP.writeIntLE,arr.writeIntBE=BP.writeIntBE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":113,ieee754:114,isarray:115}],113:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS||code===PLUS_URL_SAFE?62:code===SLASH||code===SLASH_URL_SAFE?63:NUMBER>code?-1:NUMBER+10>code?code-NUMBER+26+26:UPPER+26>code?code-UPPER:LOWER+26>code?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;l>i;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;length>i;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),
output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0),PLUS_URL_SAFE="-".charCodeAt(0),SLASH_URL_SAFE="_".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)},{}],114:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:(s?-1:1)*(1/0);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=0>value||0===value&&0>1/value?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],115:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],116:[function(require,module,exports){function drainQueue(){if(!draining){draining=!0;for(var currentQueue,len=queue.length;len;){currentQueue=queue,queue=[];for(var i=-1;++i<len;)currentQueue[i]();len=queue.length}draining=!1}}function noop(){}var process=module.exports={},queue=[],draining=!1;process.nextTick=function(fun){queue.push(fun),draining||setTimeout(drainQueue,0)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],117:[function(require,module,exports){"use strict";var _gaq=window._gaq=_gaq||[];_gaq.push(["_setAccount","UA-50837128-1"]),_gaq.push(["_trackPageview"]);var ga=document.createElement("script");ga.type="text/javascript",ga.async=!0,ga.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga,s)},{}],118:[function(require,module,exports){"use strict";var form=require("@ns/contact-form"),xhr=require("xhr");form.on("submit",function(data){xhr({uri:"careers"===data.topic?"/careers":"/contact",method:"POST",body:JSON.stringify(data),headers:{"Content-Type":"application/json"}},function(err,res,body){if(err)return form.emit("error",err);try{var data=JSON.parse(body)}catch(e){return form.emit("error",e)}"sent"===data.status?form.emit("success"):form.emit("error",new Error("Unknown error: "+body))})})},{"@ns/contact-form":2,xhr:143}],119:[function(require,module,exports){"use strict";function toggleContent(toggleTarget){var toggleWrapper=document.querySelector("section.toggle-wrapper"),visibleSections=document.querySelectorAll("section.active");toggleWrapper.classList.remove("loading");for(var i=0;i<visibleSections.length;i++)visibleSections[i].classList.toggle("active");if(toggleTarget.length>0)for(var i=0;i<toggleTarget.length;i++)toggleTarget[i].classList.toggle("active","inactive");else toggleTarget.classList.toggle("active","inactive")}function toggleClickEvent(e){for(var activeLink=e.target,activeToggler=document.querySelector("#"+activeLink.getAttribute("data")+"-link"),toggleTarget=document.querySelectorAll("."+activeLink.getAttribute("data")),i=0;i<toggler.length;i++)toggler[i].parentNode.classList.remove("active");activeToggler.classList.add("active"),toggleContent(toggleTarget);var activeHash=activeLink.parentNode.getAttribute("id").split("-link");return window.location.hash=activeHash[0],e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}var toggler=document.querySelectorAll(".content-toggler a"),preselected=window.location.href.split("#");if(toggler.length>0&&preselected[1]){var initialContent=document.querySelectorAll("."+preselected[1]),initialButton=document.querySelector("#"+preselected[1]+"-link");initialButton.classList.toggle("active"),toggleContent(initialContent)}else if(toggler.length>0){var initialContent=document.querySelectorAll("section."+toggler[0].getAttribute("data")),initialButton=toggler[0].parentNode;initialButton.classList.toggle("active"),toggleContent(initialContent)}if(toggler)for(var i=0;i<toggler.length;i++)toggler[i].addEventListener("click",toggleClickEvent)},{}],120:[function(require,module,exports){"use strict";function navScroll(){var scrollPos=window.pageYOffset;scrollPos>10?mainNav.classList.add("scrolled"):10>scrollPos&&mainNav.classList.remove("scrolled")}var mainNav=document.querySelector("nav.main-navigation");document.addEventListener("scroll",navScroll)},{}],121:[function(require,module,exports){"use strict";function Gallery(ul){var resetHeight=function(){for(var height=0,i=0;i<lis.length;i++){var bounds=size(lis[i]);bounds[1]>height&&(height=bounds[1])}ul.style.height=height+"px"},selectItem=function(e){var el=findup(e.target,function(el){return el!==nav});el&&moveTo(parseInt(el.getAttribute("data-index"),10))},moveTo=function(i){current=i,lis.forEach(function(li,j){li.style.left=120*(j-i)+"%"}),nodes.forEach(function(node,j){j===i?cl(node).add("gallery-nav-selected"):cl(node).remove("gallery-nav-selected")})},moveBy=function(n){return function(){moveTo((current+n+lis.length)%lis.length)}},nav=document.createElement("nav"),lis=slice(ul.childNodes).filter(function(el){return"LI"===el.nodeName}),navLeft=document.createElement("div"),navRight=document.createElement("div"),current=0;cl(ul).add("gallery-enabled"),cl(nav).add("gallery-nav"),cl(navLeft).add("gallery-left"),cl(navRight).add("gallery-right");var nodes=lis.map(function(li,i){var el=document.createElement("div");return cl(el).add("gallery-nav-item"),el.setAttribute("data-index",i),nav.appendChild(el)});resetHeight(),moveTo(0),window.addEventListener("resize",debounce(resetHeight),!1),nav.addEventListener("click",selectItem,!1),navLeft.addEventListener("click",moveBy(-1),!1),navRight.addEventListener("click",moveBy(1),!1),ul.insertBefore(nav,ul.childNodes[0]),ul.insertBefore(navLeft,ul.childNodes[0]),ul.insertBefore(navRight,ul.childNodes[0])}for(var galleries=document.querySelectorAll(".gallery"),debounce=require("frame-debounce"),findup=require("findup-element"),size=require("element-size"),cl=require("class-list"),slice=require("sliced"),i=0;i<galleries.length;i++)Gallery(galleries[i]);module.exports=Gallery},{"class-list":125,"element-size":130,"findup-element":131,"frame-debounce":132,sliced:141}],122:[function(require,module,exports){"use strict";function toggler(e){var href=e.target.getAttribute("href");if(!href||"#"===href)return navToggle.classList.toggle("active"),mobileMenu.classList.toggle("open"),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}var navToggle=document.querySelector(".nav-toggle"),mobileMenu=document.querySelector(".mobile-menu");navToggle&&navToggle.addEventListener("click",toggler)},{}],123:[function(require,module,exports){"use strict";var page=document.body.getAttribute("data-page");"home"===page&&require("./pages/home"),"company"===page&&require("./pages/company"),"unsubscribe"===page&&require("./pages/unsubscribe"),"blog"===page&&require("./pages/blog"),"press"===page&&require("./pages/press"),"product-nsolid"===page&&require("./pages/nsolid"),"resources"===page&&-1!==window.location.pathname.split("/").indexOf("whitepapers")&&require("./pages/email-gate"),"/services/upgrade-self-service"===window.location.pathname&&require("./pages/email-gate"),require("./elements/contact"),require("./elements/gallery"),require("./elements/mobile-menu"),require("./elements/fixednav"),require("./elements/content-toggle"),require("./social-share"),require("./analytics")},{"./analytics":117,"./elements/contact":118,"./elements/content-toggle":119,"./elements/fixednav":120,"./elements/gallery":121,"./elements/mobile-menu":122,"./pages/blog":151,"./pages/company":152,"./pages/email-gate":153,"./pages/home":154,"./pages/nsolid":155,"./pages/press":156,"./pages/unsubscribe":157,"./social-share":158}],124:[function(require,module,exports){function fit(canvas,parent,scale){function resize(){var p=resize.parent||canvas.parentNode;if("function"==typeof p)var dims=p(scratch)||scratch,width=dims[0],height=dims[1];else if(p&&p!==document.body)var psize=size(p),width=0|psize[0],height=0|psize[1];else var width=window.innerWidth,height=window.innerHeight;return isSVG?(canvas.setAttribute("width",width*resize.scale+"px"),canvas.setAttribute("height",height*resize.scale+"px")):(canvas.width=width*resize.scale,canvas.height=height*resize.scale),canvas.style.width=width+"px",canvas.style.height=height+"px",resize}var isSVG="SVG"===canvas.nodeName.toUpperCase();return canvas.style.position=canvas.style.position||"absolute",canvas.style.top=0,canvas.style.left=0,resize.scale=parseFloat(scale||1),resize.parent=parent,resize()}var size=require("element-size");module.exports=fit;var scratch=new Float32Array(2)},{"element-size":130}],125:[function(require,module,exports){arguments[4][3][0].apply(exports,arguments)},{dup:3,indexof:126}],126:[function(require,module,exports){arguments[4][4][0].apply(exports,arguments)},{dup:4}],127:[function(require,module,exports){var now=require("date-now");module.exports=function(func,wait,immediate){function later(){var last=now()-timestamp;wait>last&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))}var timeout,args,context,timestamp,result;return null==wait&&(wait=100),function(){context=this,args=arguments,timestamp=now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}}},{"date-now":128}],128:[function(require,module,exports){function now(){return(new Date).getTime()}module.exports=Date.now||now},{}],129:[function(require,module,exports){arguments[4][5][0].apply(exports,arguments)},{dup:5}],130:[function(require,module,exports){arguments[4][103][0].apply(exports,arguments)},{dup:103}],131:[function(require,module,exports){arguments[4][8][0].apply(exports,arguments)},{dup:8}],132:[function(require,module,exports){arguments[4][104][0].apply(exports,arguments)},{dup:104,raf:133,sliced:141}],133:[function(require,module,exports){arguments[4][105][0].apply(exports,arguments)},{dup:105,"performance-now":134}],134:[function(require,module,exports){arguments[4][106][0].apply(exports,arguments)},{_process:116,dup:106}],135:[function(require,module,exports){function number(n,def){return n===!1?!1:"undefined"==typeof n?def:n+0}function array(a,def){return a===!1?!1:Array.isArray(a)?a||def:def}exports.color=function(color){return array(color,[0,0,0,1])},exports.depth=function(depth){return number(depth,1)},exports.stencil=function(stencil){return number(stencil,!1)}},{}],136:[function(require,module,exports){function clear(opts){function clear(gl){var flags=0;return color!==!1&&(gl.clearColor(color[0],color[1],color[2],color[3]),flags|=gl.COLOR_BUFFER_BIT),depth!==!1&&(gl.clearDepth(depth),flags|=gl.DEPTH_BUFFER_BIT),stencil!==!1&&(gl.clearStencil(stencil),flags|=gl.STENCIL_BUFFER_BIT),gl.clear(flags),gl}opts=opts||{};var color=defaults.color(opts.color);Object.defineProperty(clear,"color",{get:function(){return color},set:function(value){return color=defaults.color(value)}});var depth=defaults.depth(opts.depth);Object.defineProperty(clear,"depth",{get:function(){return depth},set:function(value){return depth=defaults.depth(value)}});var stencil=defaults.stencil(opts.stencil);return Object.defineProperty(clear,"stencil",{get:function(){return stencil},set:function(value){return stencil=defaults.stencil(value)}}),clear}var defaults=require("./defaults");module.exports=clear},{"./defaults":135}],137:[function(require,module,exports){function createContext(canvas,opts,render){function tick(){render(gl),raf(tick)}"function"==typeof opts?(render=opts,opts={}):opts=opts||{};var gl=canvas.getContext("webgl",opts)||canvas.getContext("webgl-experimental",opts)||canvas.getContext("experimental-webgl",opts);if(!gl)throw new Error("Unable to initialize WebGL");return render&&raf(tick),gl}var raf=require("raf-component");module.exports=createContext},{"raf-component":138}],138:[function(require,module,exports){function fallback(fn){var curr=(new Date).getTime(),ms=Math.max(0,16-(curr-prev)),req=setTimeout(fn,ms);return prev=curr,req}exports=module.exports=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||fallback;var prev=(new Date).getTime(),cancel=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout;exports.cancel=function(id){cancel.call(window,id)}},{}],139:[function(require,module,exports){arguments[4][9][0].apply(exports,arguments)},{dup:9}],140:[function(require,module,exports){function remove(element){return element&&element.parentNode&&element.parentNode.removeChild(element),element}module.exports=remove},{}],141:[function(require,module,exports){arguments[4][107][0].apply(exports,arguments)},{"./lib/sliced":142,dup:107}],142:[function(require,module,exports){arguments[4][108][0].apply(exports,arguments)},{dup:108}],143:[function(require,module,exports){"use strict";function forEachArray(array,iterator){for(var i=0;i<array.length;i++)iterator(array[i])}function isEmpty(obj){for(var i in obj)if(obj.hasOwnProperty(i))return!1;return!0}function initParams(uri,options,callback){var params=uri;return isFunction(options)?(callback=options,"string"==typeof uri&&(params={uri:uri})):params=xtend(options,{uri:uri}),params.callback=callback,params}function createXHR(uri,options,callback){return options=initParams(uri,options,callback),_createXHR(options)}function _createXHR(options){function readystatechange(){4===xhr.readyState&&loadFunc()}function getBody(){var body=void 0;if(xhr.response?body=xhr.response:"text"!==xhr.responseType&&xhr.responseType||(body=xhr.responseText||xhr.responseXML),isJson)try{body=JSON.parse(body)}catch(e){}return body}function errorFunc(evt){clearTimeout(timeoutTimer),evt instanceof Error||(evt=new Error(""+(evt||"Unknown XMLHttpRequest Error"))),evt.statusCode=0,callback(evt,failureResponse)}function loadFunc(){if(!aborted){var status;clearTimeout(timeoutTimer),status=options.useXDR&&void 0===xhr.status?200:1223===xhr.status?204:xhr.status;var response=failureResponse,err=null;0!==status?(response={body:getBody(),statusCode:status,method:method,headers:{},url:uri,rawRequest:xhr},xhr.getAllResponseHeaders&&(response.headers=parseHeaders(xhr.getAllResponseHeaders()))):err=new Error("Internal XMLHttpRequest Error"),callback(err,response,response.body)}}var callback=options.callback;if("undefined"==typeof callback)throw new Error("callback argument missing");callback=once(callback);var failureResponse={body:void 0,headers:{},statusCode:0,method:method,url:uri,rawRequest:xhr},xhr=options.xhr||null;xhr||(xhr=options.cors||options.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var key,aborted,timeoutTimer,uri=xhr.url=options.uri||options.url,method=xhr.method=options.method||"GET",body=options.body||options.data||null,headers=xhr.headers=options.headers||{},sync=!!options.sync,isJson=!1;if("json"in options&&(isJson=!0,headers.accept||headers.Accept||(headers.Accept="application/json"),"GET"!==method&&"HEAD"!==method&&(headers["content-type"]||headers["Content-Type"]||(headers["Content-Type"]="application/json"),body=JSON.stringify(options.json))),xhr.onreadystatechange=readystatechange,xhr.onload=loadFunc,xhr.onerror=errorFunc,xhr.onprogress=function(){},xhr.ontimeout=errorFunc,xhr.open(method,uri,!sync,options.username,options.password),sync||(xhr.withCredentials=!!options.withCredentials),!sync&&options.timeout>0&&(timeoutTimer=setTimeout(function(){aborted=!0,xhr.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",errorFunc(e)},options.timeout)),xhr.setRequestHeader)for(key in headers)headers.hasOwnProperty(key)&&xhr.setRequestHeader(key,headers[key]);else if(options.headers&&!isEmpty(options.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in options&&(xhr.responseType=options.responseType),"beforeSend"in options&&"function"==typeof options.beforeSend&&options.beforeSend(xhr),xhr.send(body),xhr}function noop(){}var window=require("global/window"),once=require("once"),isFunction=require("is-function"),parseHeaders=require("parse-headers"),xtend=require("xtend");module.exports=createXHR,createXHR.XMLHttpRequest=window.XMLHttpRequest||noop,createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:window.XDomainRequest,forEachArray(["get","put","post","patch","head","delete"],function(method){createXHR["delete"===method?"del":method]=function(uri,options,callback){return options=initParams(uri,options,callback),options.method=method.toUpperCase(),_createXHR(options)}})},{"global/window":144,"is-function":145,once:146,"parse-headers":149,xtend:150}],144:[function(require,module,exports){(function(global){"undefined"!=typeof window?module.exports=window:"undefined"!=typeof global?module.exports=global:"undefined"!=typeof self?module.exports=self:module.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],145:[function(require,module,exports){function isFunction(fn){var string=toString.call(fn);return"[object Function]"===string||"function"==typeof fn&&"[object RegExp]"!==string||"undefined"!=typeof window&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt)}module.exports=isFunction;var toString=Object.prototype.toString},{}],146:[function(require,module,exports){function once(fn){var called=!1;return function(){return called?void 0:(called=!0,fn.apply(this,arguments))}}module.exports=once,once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0})})},{}],147:[function(require,module,exports){function forEach(list,iterator,context){if(!isFunction(iterator))throw new TypeError("iterator must be a function");arguments.length<3&&(context=this),"[object Array]"===toString.call(list)?forEachArray(list,iterator,context):"string"==typeof list?forEachString(list,iterator,context):forEachObject(list,iterator,context)}function forEachArray(array,iterator,context){for(var i=0,len=array.length;len>i;i++)hasOwnProperty.call(array,i)&&iterator.call(context,array[i],i,array)}function forEachString(string,iterator,context){for(var i=0,len=string.length;len>i;i++)iterator.call(context,string.charAt(i),i,string)}function forEachObject(object,iterator,context){for(var k in object)hasOwnProperty.call(object,k)&&iterator.call(context,object[k],k,object)}var isFunction=require("is-function");module.exports=forEach;var toString=Object.prototype.toString,hasOwnProperty=Object.prototype.hasOwnProperty},{"is-function":145}],148:[function(require,module,exports){function trim(str){return str.replace(/^\s*|\s*$/g,"")}exports=module.exports=trim,exports.left=function(str){return str.replace(/^\s*/,"")},exports.right=function(str){return str.replace(/\s*$/,"")}},{}],149:[function(require,module,exports){var trim=require("trim"),forEach=require("for-each"),isArray=function(arg){return"[object Array]"===Object.prototype.toString.call(arg)};module.exports=function(headers){if(!headers)return{};var result={};return forEach(trim(headers).split("\n"),function(row){var index=row.indexOf(":"),key=trim(row.slice(0,index)).toLowerCase(),value=trim(row.slice(index+1));"undefined"==typeof result[key]?result[key]=value:isArray(result[key])?result[key].push(value):result[key]=[result[key],value]}),result}},{"for-each":147,trim:148}],150:[function(require,module,exports){function extend(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source)hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty},{}],151:[function(require,module,exports){"use strict";function adjustAside(el){var prev=el.previousElementSibling,bounds=prev.getBoundingClientRect(),style=window.getComputedStyle(prev,null),margin=parseInt(style.margin,10);el.style.marginTop=-(bounds.height+margin)+"px"}function readMore(list){var grabPage=function(){var id=retries?curr:++curr;cl(list).add("blog-loading"),pending=!0,xhr({uri:"/blog/page/"+id+"."+head+".html"},function(err,res,body){if(err&&++retries>3)throw err;return err?grabPage():(list.insertBefore(domify(body),button),cl(list).remove("blog-loading"),retries=0,void(id>=pages?(remove(button),cl(list).remove("blog-loading")):pending=!1))})},pages=parseInt(list.getAttribute("data-page-count"),10),button=list.appendChild(document.createElement("button")),head=list.getAttribute("data-page-head"),pending=!1,curr=0,retries=0;cl(button).add("blog-load-more"),cl(button).add("secondary"),button.innerHTML="Show More",button.addEventListener("click",function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),grabPage()},!1)}var remove=require("remove-element"),cl=require("class-list"),domify=(require("debounce"),require("domify")),xhr=require("xhr"),asides=document.querySelectorAll(".markdown aside");"undefined"!=typeof hljs&&hljs.initHighlightingOnLoad();for(var i=0;i<asides.length;i++)adjustAside(asides[i]);var list=document.querySelector(".blog-list[data-page-count]");list&&readMore(list)},{"class-list":125,debounce:127,domify:129,"remove-element":140,xhr:143}],152:[function(require,module,exports){"use strict";function loaded(err,res,body){var render=function(){if(gl.drawingBufferWidth<800)return void(globe.lastTime=Date.now());var scroll=window.scrollY;if(globe.targetData.length){var startDist=globe.targetData[0].y-scroll-250;globe.opacity=1-Math.max(0,startDist/300)}clear(gl),globe.render()},resize=function(e){fit(e),globe.calculateTargetPositions()};if(err)throw err;var el=domify(minstache(template,{team:team})),canvas=el.querySelector("canvas"),clear=glClear({color:[1,1,1,1],depth:1,stencil:!1});try{var gl=Context(canvas,{premultipliedAlpha:!0},render)}catch(e){console.error(e.message),cl(document.body).add("no-webgl"),remove(this.canvas)}var positions=new Float32Array(body),globe=Globe(gl,{positions:positions,centroids:gdata.centroids,ranges:gdata.ranges,index:gdata.index});globe.targets.push.apply(globe.targets,slice(el.querySelectorAll("[data-avatar]"))),globe.on("change:selected",function(el){for(var nick=el.getAttribute("data-avatar"),i=0;i<team.length;i++)team[i].nick===nick&&(globe.country=team[i].country3,globe.pointTo(getTeamLocation(team[i])))}),globe.selectElement(globe.targets[0]),document.getElementById("globe").appendChild(el),setTimeout(function(_){return globe.calculateTargetPositions()},150);var fit=require("canvas-fit")(canvas,window);window.addEventListener("resize",debounce(resize),!1);var name=String(window.location.hash).replace("#",""),el=name&&document.getElementById(name);el&&el.scrollIntoView({behavior:"smooth"})}function getTeamLocation(member){return cartesian(member.lat,member.lon,new Float32Array(3))}var gdata=require("@ns/globe/data/metadata.json"),cartesian=require("@ns/globe/cartesian"),debounce=require("frame-debounce"),remove=require("remove-element"),cl=require("class-list"),Context=require("gl-context"),minstache=require("minstache"),Globe=require("@ns/globe"),team=require("@ns/team"),glClear=require("gl-clear"),slice=require("sliced"),domify=require("domify"),xhr=require("xhr"),template='<div class="globe">\n  <canvas></canvas>\n  <section>\n    <ul class="globe-team">\n      {{#team}}\n        <li class="globe-member">\n          <a style="transform: translate(0, -120px); display: block; opacity: 0; position: absolute;" id="{{nick}}"></a>\n          <img\n            data-avatar="{{nick}}"\n            class="globe-avatar"\n            src="/team/{{nick}}.jpg"\n            alt="{{name}}"\n            width="64px"\n            height="64px"\n           />\n          <div class="globe-member-headers">\n            <h2>\n              {{name}}\n              {{#github}}\n                <a target="_blank" title="@{{github}}" href="http://github.com/{{github}}" class="icon icon-github"></a>\n              {{/github}}\n              {{#twitter}}\n                <a target="_blank" title="@{{twitter}}" href="http://twitter.com/{{twitter}}" class="icon icon-twitter"></a>\n              {{/twitter}}\n            </h2>\n            <h4 class="subtle">\n              {{location_full}}\n            </h4>\n          </div>\n          <div class="globe-bio">\n            {{!bio}}\n          </div>\n        </li>\n      {{/team}}\n    </ul>\n  </section>\n</div>\n';team.sort(function(_){return 2*(Math.random()-.5)});var IS_SAFARI=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome");require("@ns/team-banner")(document.getElementById("company-header")),IS_SAFARI?(console.error("Globe is sadly not supported in Safari due to slow WebGL performance"),cl(document.body).add("no-webgl")):xhr("/globe/positions.bin",loaded).responseType="arraybuffer"},{"@ns/globe":13,"@ns/globe/cartesian":11,"@ns/globe/data/metadata.json":12,"@ns/team":111,"@ns/team-banner":102,"canvas-fit":124,"class-list":125,domify:129,"frame-debounce":132,"gl-clear":136,"gl-context":137,minstache:139,"remove-element":140,sliced:141,xhr:143}],153:[function(require,module,exports){"use strict";function preventDefault(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function hideEmailForm(){document.querySelector("body").classList.remove("email-form-visible")}setTimeout(function(){-1===document.cookie.split("; ").indexOf("infoStored=true")&&(document.querySelector("body").classList.add("email-form-visible"),document.querySelector(".email-form").addEventListener("submit",function(ev){return document.querySelector(".email-form-complete").style.visibility="visible",document.querySelector("body").classList.add("email-form-success"),document.cookie="infoStored=true",setTimeout(hideEmailForm,2e3),preventDefault(ev)},!1));for(var closeBtn=document.querySelectorAll(".email-form-close"),b=0;b<closeBtn.length;b++)closeBtn[b].addEventListener("click",function(e){return hideEmailForm(),preventDefault(e)},!1);document.querySelector(".email-form").addEventListener("reset",function(e){return hideEmailForm(),preventDefault(e)},!1),window.addEventListener("keydown",function(e){27===e.keyCode&&hideEmailForm()},!1)},700)},{}],154:[function(require,module,exports){"use strict";var xhr=require("xhr");xhr({url:"/blog/home-feed/",useXDR:!0,method:"GET"},function(err,data){var blogDiv=document.querySelector(".blog-list");blogDiv.innerHTML=data.body})},{xhr:143}],155:[function(require,module,exports){"use strict";function fixUsecaseNav(){var pageWidth=document.documentElement.offsetWidth,scrollPos=window.pageYOffset;if(pageWidth>800)var navPos=rawNavPos-mainNavHeight;else if(800>=pageWidth)var navPos=rawNavPos-mobileNavHeight;scrollPos>navPos?usecaseNav.classList.add("scrolled"):navPos>scrollPos&&usecaseNav.classList.remove("scrolled")}var getVideos=document.querySelectorAll("video"),controlVideo=function(e){if(e.target){if(e.target.classList.contains("video-cover"))var videoID=e.target.getAttribute("ID").split("-cover"),cover=e.target;else if(e.target.classList.contains("play-button"))var videoID=e.target.getAttribute("ID").split("-play-button"),cover=e.target.parentNode;var videoTarget=document.querySelector("#"+videoID[0]);videoTarget.paused&&!videoTarget.ended&&(videoTarget.play(),cover.classList.add("hidden"),setTimeout(function(){cover.classList.add("gone")},750))}},resizeCover=function(video){var vidWidth=(video.getAttribute("data-cover"),video.offsetWidth),vidHeight=video.offsetHeight,cover=document.querySelector("#"+video.getAttribute("ID")+"-cover");cover.style.width=vidWidth+"px",cover.style.height=vidHeight+"px"},initializeVideos=function(){for(var i=0;i<getVideos.length;i++){var coverURL=getVideos[i].getAttribute("data-cover"),cover=(getVideos[i].offsetWidth,document.createElement("div")),newID=getVideos[i].getAttribute("ID")+"-cover";cover.classList.add("video-cover"),cover.setAttribute("id",newID),cover.setAttribute("style","background-image: url('"+coverURL+"');"),getVideos[i].parentNode.appendChild(cover),cover=document.querySelector("#"+getVideos[i].getAttribute("ID")+"-cover"),cover.addEventListener("click",controlVideo);var playButton=document.createElement("button"),buttonID=getVideos[i].getAttribute("ID")+"-play-button";playButton.classList.add("play-button"),playButton.setAttribute("id",buttonID),cover.appendChild(playButton),resizeCover(getVideos[i])}for(var playButton=document.querySelectorAll("#"+buttonID),i=0;i<playButton.length;i++)playButton[i].addEventListener("click",controlVideo(getVideos[i]));window.addEventListener("resize",resizeAllCovers)},resizeAllCovers=function(){for(var i=0;i<getVideos.length;i++)resizeCover(getVideos[i])};initializeVideos(),setTimeout(resizeAllCovers,350);for(var toggleLinks=document.querySelectorAll(".content-toggler a"),i=0;i<toggleLinks.length;i++)toggleLinks[i].addEventListener("click",function(){setTimeout(resizeAllCovers,350)});var usecaseNav=(document.querySelector("nav.main-navigation"),document.querySelector("#use-case-nav ul.content-toggle")),rawNavPos=usecaseNav.offsetParent.offsetTop+usecaseNav.offsetTop,mainNavHeight=68,mobileNavHeight=44;document.addEventListener("scroll",fixUsecaseNav),document.addEventListener("resize",fixUsecaseNav)},{}],156:[function(require,module,exports){"use strict";function showMoreItems(){for(var currCount=showCount,i=currCount;currCount+6>i&&i<newsItems.length;i++)newsItems[i].classList.add("visible"),showCount+=1,showCount==newsItems.length&&(showMoreButton.style.display="none")}function showClick(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),showMoreItems()}var newsItems=document.querySelectorAll("#nodesource-news ul#news-grid li"),showMoreButton=document.querySelector("#show-more-news"),showCount=0;showMoreButton.addEventListener("click",showClick),showMoreItems()},{}],157:[function(require,module,exports){"use strict";var utmParam=window.location.href.split("?"),subscriptionLabel=document.querySelector("#subscriptionTitle"),subscriptionSection=document.querySelector("#subscriptionSection");if(utmParam[1]&&utmParam[1].split("utm_source=")[1].split("&")[0]){var subscriptionName=utmParam[1].split("utm_source=")[1].split("&")[0];subscriptionLabel.innerHTML=subscriptionName,
subscriptionSection.classList.add("success")}else subscriptionSection.classList.add("failure")},{}],158:[function(require,module,exports){"use strict";function sharer(event){var el=event.target,link=event.target.parentElement,url=document.URL;null!==el.firstChild&&(el=el.firstChild,link=event.target);var site=el.className.replace("icon-",""),shareUrl=socialSites[site];link.dataset.video&&(url="https://vimeo.com/"+link.dataset.video),shareUrl=shareUrl.replace("{{url}}",encodeURIComponent(url));var hasSocialText=document.querySelector('meta[name="description"]'),title=document.title,shareText=hasSocialText&&""!==hasSocialText.content?hasSocialText.content:title;shareUrl=shareUrl.replace("{{title}}",encodeURIComponent(shareText)),link.href=shareUrl,_gaq.push(["_trackEvent",site,"Social Share",title])}for(var socialSites={twitter:"https://www.twitter.com/intent/tweet?url={{url}}&text={{title}}",linkedin:"https://www.linkedin.com/shareArticle?mini=true&url={{url}}",googleplus:"https://plus.google.com/share?url={{url}}",facebook:"https://www.facebook.com/sharer/sharer.php?u={{url}}&t={{title}}"},socialButtons=document.querySelectorAll(".social-button, .social-video"),i=0;i<socialButtons.length;i++)socialButtons[i].addEventListener("click",sharer)},{}]},{},[123]);